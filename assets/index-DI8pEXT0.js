(function(){const relList=document.createElement("link").relList;if(relList&&relList.supports&&relList.supports("modulepreload"))return;for(const link of document.querySelectorAll('link[rel="modulepreload"]'))processPreload(link);new MutationObserver(mutations=>{for(const mutation of mutations)if(mutation.type==="childList")for(const node of mutation.addedNodes)node.tagName==="LINK"&&node.rel==="modulepreload"&&processPreload(node)}).observe(document,{childList:!0,subtree:!0});function getFetchOpts(link){const fetchOpts={};return link.integrity&&(fetchOpts.integrity=link.integrity),link.referrerPolicy&&(fetchOpts.referrerPolicy=link.referrerPolicy),link.crossOrigin==="use-credentials"?fetchOpts.credentials="include":link.crossOrigin==="anonymous"?fetchOpts.credentials="omit":fetchOpts.credentials="same-origin",fetchOpts}function processPreload(link){if(link.ep)return;link.ep=!0;const fetchOpts=getFetchOpts(link);fetch(link.href,fetchOpts)}})();const scriptRel="modulepreload",assetsURL=function(dep,importerUrl){return new URL(dep,importerUrl).href},seen={},__vitePreload=function(baseModule,deps,importerUrl){let promise=Promise.resolve();if(deps&&deps.length>0){const links=document.getElementsByTagName("link"),cspNonceMeta=document.querySelector("meta[property=csp-nonce]"),cspNonce=(cspNonceMeta==null?void 0:cspNonceMeta.nonce)||(cspNonceMeta==null?void 0:cspNonceMeta.getAttribute("nonce"));promise=Promise.all(deps.map(dep=>{if(dep=assetsURL(dep,importerUrl),dep in seen)return;seen[dep]=!0;const isCss=dep.endsWith(".css"),cssSelector=isCss?'[rel="stylesheet"]':"";if(!!importerUrl)for(let i=links.length-1;i>=0;i--){const link2=links[i];if(link2.href===dep&&(!isCss||link2.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${dep}"]${cssSelector}`))return;const link=document.createElement("link");if(link.rel=isCss?"stylesheet":scriptRel,isCss||(link.as="script",link.crossOrigin=""),link.href=dep,cspNonce&&link.setAttribute("nonce",cspNonce),document.head.appendChild(link),isCss)return new Promise((res,rej)=>{link.addEventListener("load",res),link.addEventListener("error",()=>rej(new Error(`Unable to preload CSS for ${dep}`)))})}))}return promise.then(()=>baseModule()).catch(err=>{const e=new Event("vite:preloadError",{cancelable:!0});if(e.payload=err,window.dispatchEvent(e),!e.defaultPrevented)throw err})},styling$global=new CSSStyleSheet;styling$global.insertRule(`
        body,
        body * {
            box-sizing: border-box;
            padding: 0;
            margin: 0;
        }
    `);styling$global.insertRule(`
        body {
            overflow: hidden;
        }
    `);document.adoptedStyleSheets.push(styling$global);var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Core={exports:{}},_CoreInternals={},Global={};(function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports._registerNode=exports.Konva=exports.glob=void 0;const PI_OVER_180=Math.PI/180;function detectBrowser(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}exports.glob=typeof commonjsGlobal<"u"?commonjsGlobal:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},exports.Konva={_global:exports.glob,version:"9.3.14",isBrowser:detectBrowser(),isUnminified:/param/.test((function(param){}).toString()),dblClickWindow:400,getAngle(angle){return exports.Konva.angleDeg?angle*PI_OVER_180:angle},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return exports.Konva.DD.isDragging},isTransforming(){var _a;return(_a=exports.Konva.Transformer)===null||_a===void 0?void 0:_a.isTransforming()},isDragReady(){return!!exports.Konva.DD.node},releaseCanvasOnDestroy:!0,document:exports.glob.document,_injectGlobal(Konva){exports.glob.Konva=Konva}};const _registerNode=NodeClass=>{exports.Konva[NodeClass.prototype.getClassName()]=NodeClass};exports._registerNode=_registerNode,exports.Konva._injectGlobal(exports.Konva)})(Global);var Util={};(function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.Util=exports.Transform=void 0;const Global_12=Global;class Transform{constructor(m=[1,0,0,1,0,0]){this.dirty=!1,this.m=m&&m.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new Transform(this.m)}copyInto(tr){tr.m[0]=this.m[0],tr.m[1]=this.m[1],tr.m[2]=this.m[2],tr.m[3]=this.m[3],tr.m[4]=this.m[4],tr.m[5]=this.m[5]}point(point){var m=this.m;return{x:m[0]*point.x+m[2]*point.y+m[4],y:m[1]*point.x+m[3]*point.y+m[5]}}translate(x,y){return this.m[4]+=this.m[0]*x+this.m[2]*y,this.m[5]+=this.m[1]*x+this.m[3]*y,this}scale(sx,sy){return this.m[0]*=sx,this.m[1]*=sx,this.m[2]*=sy,this.m[3]*=sy,this}rotate(rad){var c=Math.cos(rad),s=Math.sin(rad),m11=this.m[0]*c+this.m[2]*s,m12=this.m[1]*c+this.m[3]*s,m21=this.m[0]*-s+this.m[2]*c,m22=this.m[1]*-s+this.m[3]*c;return this.m[0]=m11,this.m[1]=m12,this.m[2]=m21,this.m[3]=m22,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(sx,sy){var m11=this.m[0]+this.m[2]*sy,m12=this.m[1]+this.m[3]*sy,m21=this.m[2]+this.m[0]*sx,m22=this.m[3]+this.m[1]*sx;return this.m[0]=m11,this.m[1]=m12,this.m[2]=m21,this.m[3]=m22,this}multiply(matrix){var m11=this.m[0]*matrix.m[0]+this.m[2]*matrix.m[1],m12=this.m[1]*matrix.m[0]+this.m[3]*matrix.m[1],m21=this.m[0]*matrix.m[2]+this.m[2]*matrix.m[3],m22=this.m[1]*matrix.m[2]+this.m[3]*matrix.m[3],dx=this.m[0]*matrix.m[4]+this.m[2]*matrix.m[5]+this.m[4],dy=this.m[1]*matrix.m[4]+this.m[3]*matrix.m[5]+this.m[5];return this.m[0]=m11,this.m[1]=m12,this.m[2]=m21,this.m[3]=m22,this.m[4]=dx,this.m[5]=dy,this}invert(){var d=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),m0=this.m[3]*d,m1=-this.m[1]*d,m2=-this.m[2]*d,m3=this.m[0]*d,m4=d*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),m5=d*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=m0,this.m[1]=m1,this.m[2]=m2,this.m[3]=m3,this.m[4]=m4,this.m[5]=m5,this}getMatrix(){return this.m}decompose(){var a=this.m[0],b=this.m[1],c=this.m[2],d=this.m[3],e=this.m[4],f=this.m[5],delta=a*d-b*c;let result={x:e,y:f,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(a!=0||b!=0){var r=Math.sqrt(a*a+b*b);result.rotation=b>0?Math.acos(a/r):-Math.acos(a/r),result.scaleX=r,result.scaleY=delta/r,result.skewX=(a*c+b*d)/delta,result.skewY=0}else if(c!=0||d!=0){var s=Math.sqrt(c*c+d*d);result.rotation=Math.PI/2-(d>0?Math.acos(-c/s):-Math.acos(c/s)),result.scaleX=delta/s,result.scaleY=s,result.skewX=0,result.skewY=(a*c+b*d)/delta}return result.rotation=exports.Util._getRotation(result.rotation),result}}exports.Transform=Transform;var OBJECT_ARRAY="[object Array]",OBJECT_NUMBER="[object Number]",OBJECT_STRING="[object String]",OBJECT_BOOLEAN="[object Boolean]",PI_OVER_DEG180=Math.PI/180,DEG180_OVER_PI=180/Math.PI,HASH2="#",EMPTY_STRING="",ZERO="0",KONVA_WARNING="Konva warning: ",KONVA_ERROR="Konva error: ",RGB_PAREN="rgb(",COLORS={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},RGB_REGEX=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,animQueue=[];const req=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(f){setTimeout(f,60)};exports.Util={_isElement(obj){return!!(obj&&obj.nodeType==1)},_isFunction(obj){return!!(obj&&obj.constructor&&obj.call&&obj.apply)},_isPlainObject(obj){return!!obj&&obj.constructor===Object},_isArray(obj){return Object.prototype.toString.call(obj)===OBJECT_ARRAY},_isNumber(obj){return Object.prototype.toString.call(obj)===OBJECT_NUMBER&&!isNaN(obj)&&isFinite(obj)},_isString(obj){return Object.prototype.toString.call(obj)===OBJECT_STRING},_isBoolean(obj){return Object.prototype.toString.call(obj)===OBJECT_BOOLEAN},isObject(val){return val instanceof Object},isValidSelector(selector){if(typeof selector!="string")return!1;var firstChar=selector[0];return firstChar==="#"||firstChar==="."||firstChar===firstChar.toUpperCase()},_sign(number){return number===0||number>0?1:-1},requestAnimFrame(callback){animQueue.push(callback),animQueue.length===1&&req(function(){const queue=animQueue;animQueue=[],queue.forEach(function(cb){cb()})})},createCanvasElement(){var canvas=document.createElement("canvas");try{canvas.style=canvas.style||{}}catch{}return canvas},createImageElement(){return document.createElement("img")},_isInDocument(el){for(;el=el.parentNode;)if(el==document)return!0;return!1},_urlToImage(url,callback){var imageObj=exports.Util.createImageElement();imageObj.onload=function(){callback(imageObj)},imageObj.src=url},_rgbToHex(r,g,b){return((1<<24)+(r<<16)+(g<<8)+b).toString(16).slice(1)},_hexToRgb(hex){hex=hex.replace(HASH2,EMPTY_STRING);var bigint=parseInt(hex,16);return{r:bigint>>16&255,g:bigint>>8&255,b:bigint&255}},getRandomColor(){for(var randColor=(Math.random()*16777215<<0).toString(16);randColor.length<6;)randColor=ZERO+randColor;return HASH2+randColor},getRGB(color){var rgb;return color in COLORS?(rgb=COLORS[color],{r:rgb[0],g:rgb[1],b:rgb[2]}):color[0]===HASH2?this._hexToRgb(color.substring(1)):color.substr(0,4)===RGB_PAREN?(rgb=RGB_REGEX.exec(color.replace(/ /g,"")),{r:parseInt(rgb[1],10),g:parseInt(rgb[2],10),b:parseInt(rgb[3],10)}):{r:0,g:0,b:0}},colorToRGBA(str){return str=str||"black",exports.Util._namedColorToRBA(str)||exports.Util._hex3ColorToRGBA(str)||exports.Util._hex4ColorToRGBA(str)||exports.Util._hex6ColorToRGBA(str)||exports.Util._hex8ColorToRGBA(str)||exports.Util._rgbColorToRGBA(str)||exports.Util._rgbaColorToRGBA(str)||exports.Util._hslColorToRGBA(str)},_namedColorToRBA(str){var c=COLORS[str.toLowerCase()];return c?{r:c[0],g:c[1],b:c[2],a:1}:null},_rgbColorToRGBA(str){if(str.indexOf("rgb(")===0){str=str.match(/rgb\(([^)]+)\)/)[1];var parts=str.split(/ *, */).map(Number);return{r:parts[0],g:parts[1],b:parts[2],a:1}}},_rgbaColorToRGBA(str){if(str.indexOf("rgba(")===0){str=str.match(/rgba\(([^)]+)\)/)[1];var parts=str.split(/ *, */).map((n,index)=>n.slice(-1)==="%"?index===3?parseInt(n)/100:parseInt(n)/100*255:Number(n));return{r:parts[0],g:parts[1],b:parts[2],a:parts[3]}}},_hex8ColorToRGBA(str){if(str[0]==="#"&&str.length===9)return{r:parseInt(str.slice(1,3),16),g:parseInt(str.slice(3,5),16),b:parseInt(str.slice(5,7),16),a:parseInt(str.slice(7,9),16)/255}},_hex6ColorToRGBA(str){if(str[0]==="#"&&str.length===7)return{r:parseInt(str.slice(1,3),16),g:parseInt(str.slice(3,5),16),b:parseInt(str.slice(5,7),16),a:1}},_hex4ColorToRGBA(str){if(str[0]==="#"&&str.length===5)return{r:parseInt(str[1]+str[1],16),g:parseInt(str[2]+str[2],16),b:parseInt(str[3]+str[3],16),a:parseInt(str[4]+str[4],16)/255}},_hex3ColorToRGBA(str){if(str[0]==="#"&&str.length===4)return{r:parseInt(str[1]+str[1],16),g:parseInt(str[2]+str[2],16),b:parseInt(str[3]+str[3],16),a:1}},_hslColorToRGBA(str){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(str)){const[_,...hsl]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(str),h=Number(hsl[0])/360,s=Number(hsl[1])/100,l=Number(hsl[2])/100;let t2,t3,val;if(s===0)return val=l*255,{r:Math.round(val),g:Math.round(val),b:Math.round(val),a:1};l<.5?t2=l*(1+s):t2=l+s-l*s;const t1=2*l-t2,rgb=[0,0,0];for(let i=0;i<3;i++)t3=h+1/3*-(i-1),t3<0&&t3++,t3>1&&t3--,6*t3<1?val=t1+(t2-t1)*6*t3:2*t3<1?val=t2:3*t3<2?val=t1+(t2-t1)*(2/3-t3)*6:val=t1,rgb[i]=val*255;return{r:Math.round(rgb[0]),g:Math.round(rgb[1]),b:Math.round(rgb[2]),a:1}}},haveIntersection(r1,r2){return!(r2.x>r1.x+r1.width||r2.x+r2.width<r1.x||r2.y>r1.y+r1.height||r2.y+r2.height<r1.y)},cloneObject(obj){var retObj={};for(var key in obj)this._isPlainObject(obj[key])?retObj[key]=this.cloneObject(obj[key]):this._isArray(obj[key])?retObj[key]=this.cloneArray(obj[key]):retObj[key]=obj[key];return retObj},cloneArray(arr){return arr.slice(0)},degToRad(deg){return deg*PI_OVER_DEG180},radToDeg(rad){return rad*DEG180_OVER_PI},_degToRad(deg){return exports.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),exports.Util.degToRad(deg)},_radToDeg(rad){return exports.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),exports.Util.radToDeg(rad)},_getRotation(radians){return Global_12.Konva.angleDeg?exports.Util.radToDeg(radians):radians},_capitalize(str){return str.charAt(0).toUpperCase()+str.slice(1)},throw(str){throw new Error(KONVA_ERROR+str)},error(str){console.error(KONVA_ERROR+str)},warn(str){Global_12.Konva.showWarnings&&console.warn(KONVA_WARNING+str)},each(obj,func){for(var key in obj)func(key,obj[key])},_inRange(val,left,right){return left<=val&&val<right},_getProjectionToSegment(x1,y1,x2,y2,x3,y3){var x,y,dist,pd2=(x1-x2)*(x1-x2)+(y1-y2)*(y1-y2);if(pd2==0)x=x1,y=y1,dist=(x3-x2)*(x3-x2)+(y3-y2)*(y3-y2);else{var u=((x3-x1)*(x2-x1)+(y3-y1)*(y2-y1))/pd2;u<0?(x=x1,y=y1,dist=(x1-x3)*(x1-x3)+(y1-y3)*(y1-y3)):u>1?(x=x2,y=y2,dist=(x2-x3)*(x2-x3)+(y2-y3)*(y2-y3)):(x=x1+u*(x2-x1),y=y1+u*(y2-y1),dist=(x-x3)*(x-x3)+(y-y3)*(y-y3))}return[x,y,dist]},_getProjectionToLine(pt,line,isClosed){var pc=exports.Util.cloneObject(pt),dist=Number.MAX_VALUE;return line.forEach(function(p1,i){if(!(!isClosed&&i===line.length-1)){var p2=line[(i+1)%line.length],proj=exports.Util._getProjectionToSegment(p1.x,p1.y,p2.x,p2.y,pt.x,pt.y),px=proj[0],py=proj[1],pdist=proj[2];pdist<dist&&(pc.x=px,pc.y=py,dist=pdist)}}),pc},_prepareArrayForTween(startArray,endArray,isClosed){var n,start=[],end=[];if(startArray.length>endArray.length){var temp=endArray;endArray=startArray,startArray=temp}for(n=0;n<startArray.length;n+=2)start.push({x:startArray[n],y:startArray[n+1]});for(n=0;n<endArray.length;n+=2)end.push({x:endArray[n],y:endArray[n+1]});var newStart=[];return end.forEach(function(point){var pr=exports.Util._getProjectionToLine(point,start,isClosed);newStart.push(pr.x),newStart.push(pr.y)}),newStart},_prepareToStringify(obj){var desc;obj.visitedByCircularReferenceRemoval=!0;for(var key in obj)if(obj.hasOwnProperty(key)&&obj[key]&&typeof obj[key]=="object"){if(desc=Object.getOwnPropertyDescriptor(obj,key),obj[key].visitedByCircularReferenceRemoval||exports.Util._isElement(obj[key]))if(desc.configurable)delete obj[key];else return null;else if(exports.Util._prepareToStringify(obj[key])===null)if(desc.configurable)delete obj[key];else return null}return delete obj.visitedByCircularReferenceRemoval,obj},_assign(target,source){for(var key in source)target[key]=source[key];return target},_getFirstPointerId(evt){return evt.touches?evt.changedTouches[0].identifier:evt.pointerId||999},releaseCanvas(...canvases){Global_12.Konva.releaseCanvasOnDestroy&&canvases.forEach(c=>{c.width=0,c.height=0})},drawRoundedRectPath(context,width,height,cornerRadius){let topLeft=0,topRight=0,bottomLeft=0,bottomRight=0;typeof cornerRadius=="number"?topLeft=topRight=bottomLeft=bottomRight=Math.min(cornerRadius,width/2,height/2):(topLeft=Math.min(cornerRadius[0]||0,width/2,height/2),topRight=Math.min(cornerRadius[1]||0,width/2,height/2),bottomRight=Math.min(cornerRadius[2]||0,width/2,height/2),bottomLeft=Math.min(cornerRadius[3]||0,width/2,height/2)),context.moveTo(topLeft,0),context.lineTo(width-topRight,0),context.arc(width-topRight,topRight,topRight,Math.PI*3/2,0,!1),context.lineTo(width,height-bottomRight),context.arc(width-bottomRight,height-bottomRight,bottomRight,0,Math.PI/2,!1),context.lineTo(bottomLeft,height),context.arc(bottomLeft,height-bottomLeft,bottomLeft,Math.PI/2,Math.PI,!1),context.lineTo(0,topLeft),context.arc(topLeft,topLeft,topLeft,Math.PI,Math.PI*3/2,!1)}}})(Util);var Node$1={},Factory={},Validators={};Object.defineProperty(Validators,"__esModule",{value:!0});Validators.getComponentValidator=Validators.getBooleanValidator=Validators.getNumberArrayValidator=Validators.getFunctionValidator=Validators.getStringOrGradientValidator=Validators.getStringValidator=Validators.getNumberOrAutoValidator=Validators.getNumberOrArrayOfNumbersValidator=Validators.getNumberValidator=Validators.alphaComponent=Validators.RGBComponent=void 0;const Global_1$c=Global,Util_1$8=Util;function _formatValue(val){return Util_1$8.Util._isString(val)?'"'+val+'"':Object.prototype.toString.call(val)==="[object Number]"||Util_1$8.Util._isBoolean(val)?val:Object.prototype.toString.call(val)}function RGBComponent(val){return val>255?255:val<0?0:Math.round(val)}Validators.RGBComponent=RGBComponent;function alphaComponent(val){return val>1?1:val<1e-4?1e-4:val}Validators.alphaComponent=alphaComponent;function getNumberValidator(){if(Global_1$c.Konva.isUnminified)return function(val,attr){return Util_1$8.Util._isNumber(val)||Util_1$8.Util.warn(_formatValue(val)+' is a not valid value for "'+attr+'" attribute. The value should be a number.'),val}}Validators.getNumberValidator=getNumberValidator;function getNumberOrArrayOfNumbersValidator(noOfElements){if(Global_1$c.Konva.isUnminified)return function(val,attr){let isNumber=Util_1$8.Util._isNumber(val),isValidArray=Util_1$8.Util._isArray(val)&&val.length==noOfElements;return!isNumber&&!isValidArray&&Util_1$8.Util.warn(_formatValue(val)+' is a not valid value for "'+attr+'" attribute. The value should be a number or Array<number>('+noOfElements+")"),val}}Validators.getNumberOrArrayOfNumbersValidator=getNumberOrArrayOfNumbersValidator;function getNumberOrAutoValidator(){if(Global_1$c.Konva.isUnminified)return function(val,attr){var isNumber=Util_1$8.Util._isNumber(val),isAuto=val==="auto";return isNumber||isAuto||Util_1$8.Util.warn(_formatValue(val)+' is a not valid value for "'+attr+'" attribute. The value should be a number or "auto".'),val}}Validators.getNumberOrAutoValidator=getNumberOrAutoValidator;function getStringValidator(){if(Global_1$c.Konva.isUnminified)return function(val,attr){return Util_1$8.Util._isString(val)||Util_1$8.Util.warn(_formatValue(val)+' is a not valid value for "'+attr+'" attribute. The value should be a string.'),val}}Validators.getStringValidator=getStringValidator;function getStringOrGradientValidator(){if(Global_1$c.Konva.isUnminified)return function(val,attr){const isString=Util_1$8.Util._isString(val),isGradient=Object.prototype.toString.call(val)==="[object CanvasGradient]"||val&&val.addColorStop;return isString||isGradient||Util_1$8.Util.warn(_formatValue(val)+' is a not valid value for "'+attr+'" attribute. The value should be a string or a native gradient.'),val}}Validators.getStringOrGradientValidator=getStringOrGradientValidator;function getFunctionValidator(){if(Global_1$c.Konva.isUnminified)return function(val,attr){return Util_1$8.Util._isFunction(val)||Util_1$8.Util.warn(_formatValue(val)+' is a not valid value for "'+attr+'" attribute. The value should be a function.'),val}}Validators.getFunctionValidator=getFunctionValidator;function getNumberArrayValidator(){if(Global_1$c.Konva.isUnminified)return function(val,attr){const TypedArray=Int8Array?Object.getPrototypeOf(Int8Array):null;return TypedArray&&val instanceof TypedArray||(Util_1$8.Util._isArray(val)?val.forEach(function(item){Util_1$8.Util._isNumber(item)||Util_1$8.Util.warn('"'+attr+'" attribute has non numeric element '+item+". Make sure that all elements are numbers.")}):Util_1$8.Util.warn(_formatValue(val)+' is a not valid value for "'+attr+'" attribute. The value should be a array of numbers.')),val}}Validators.getNumberArrayValidator=getNumberArrayValidator;function getBooleanValidator(){if(Global_1$c.Konva.isUnminified)return function(val,attr){var isBool=val===!0||val===!1;return isBool||Util_1$8.Util.warn(_formatValue(val)+' is a not valid value for "'+attr+'" attribute. The value should be a boolean.'),val}}Validators.getBooleanValidator=getBooleanValidator;function getComponentValidator(components){if(Global_1$c.Konva.isUnminified)return function(val,attr){return val==null||Util_1$8.Util.isObject(val)||Util_1$8.Util.warn(_formatValue(val)+' is a not valid value for "'+attr+'" attribute. The value should be an object with properties '+components),val}}Validators.getComponentValidator=getComponentValidator;(function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.Factory=void 0;const Util_12=Util,Validators_12=Validators;var GET="get",SET2="set";exports.Factory={addGetterSetter(constructor,attr,def,validator,after){exports.Factory.addGetter(constructor,attr,def),exports.Factory.addSetter(constructor,attr,validator,after),exports.Factory.addOverloadedGetterSetter(constructor,attr)},addGetter(constructor,attr,def){var method=GET+Util_12.Util._capitalize(attr);constructor.prototype[method]=constructor.prototype[method]||function(){var val=this.attrs[attr];return val===void 0?def:val}},addSetter(constructor,attr,validator,after){var method=SET2+Util_12.Util._capitalize(attr);constructor.prototype[method]||exports.Factory.overWriteSetter(constructor,attr,validator,after)},overWriteSetter(constructor,attr,validator,after){var method=SET2+Util_12.Util._capitalize(attr);constructor.prototype[method]=function(val){return validator&&val!==void 0&&val!==null&&(val=validator.call(this,val,attr)),this._setAttr(attr,val),after&&after.call(this),this}},addComponentsGetterSetter(constructor,attr,components,validator,after){var len=components.length,capitalize=Util_12.Util._capitalize,getter=GET+capitalize(attr),setter=SET2+capitalize(attr),n,component;constructor.prototype[getter]=function(){var ret={};for(n=0;n<len;n++)component=components[n],ret[component]=this.getAttr(attr+capitalize(component));return ret};var basicValidator=(0,Validators_12.getComponentValidator)(components);constructor.prototype[setter]=function(val){var oldVal=this.attrs[attr],key;validator&&(val=validator.call(this,val)),basicValidator&&basicValidator.call(this,val,attr);for(key in val)val.hasOwnProperty(key)&&this._setAttr(attr+capitalize(key),val[key]);return val||components.forEach(component2=>{this._setAttr(attr+capitalize(component2),void 0)}),this._fireChangeEvent(attr,oldVal,val),after&&after.call(this),this},exports.Factory.addOverloadedGetterSetter(constructor,attr)},addOverloadedGetterSetter(constructor,attr){var capitalizedAttr=Util_12.Util._capitalize(attr),setter=SET2+capitalizedAttr,getter=GET+capitalizedAttr;constructor.prototype[attr]=function(){return arguments.length?(this[setter](arguments[0]),this):this[getter]()}},addDeprecatedGetterSetter(constructor,attr,def,validator){Util_12.Util.error("Adding deprecated "+attr);var method=GET+Util_12.Util._capitalize(attr),message=attr+" property is deprecated and will be removed soon. Look at Konva change log for more information.";constructor.prototype[method]=function(){Util_12.Util.error(message);var val=this.attrs[attr];return val===void 0?def:val},exports.Factory.addSetter(constructor,attr,validator,function(){Util_12.Util.error(message)}),exports.Factory.addOverloadedGetterSetter(constructor,attr)},backCompat(constructor,methods){Util_12.Util.each(methods,function(oldMethodName,newMethodName){var method=constructor.prototype[newMethodName],oldGetter=GET+Util_12.Util._capitalize(oldMethodName),oldSetter=SET2+Util_12.Util._capitalize(oldMethodName);function deprecated(){method.apply(this,arguments),Util_12.Util.error('"'+oldMethodName+'" method is deprecated and will be removed soon. Use ""'+newMethodName+'" instead.')}constructor.prototype[oldMethodName]=deprecated,constructor.prototype[oldGetter]=deprecated,constructor.prototype[oldSetter]=deprecated})},afterSetFilter(){this._filterUpToDate=!1}}})(Factory);var Canvas$1={},Context$1={};Object.defineProperty(Context$1,"__esModule",{value:!0});Context$1.HitContext=Context$1.SceneContext=Context$1.Context=void 0;const Util_1$7=Util,Global_1$b=Global;function simplifyArray(arr){var retArr=[],len=arr.length,util=Util_1$7.Util,n,val;for(n=0;n<len;n++)val=arr[n],util._isNumber(val)?val=Math.round(val*1e3)/1e3:util._isString(val)||(val=val+""),retArr.push(val);return retArr}var COMMA=",",OPEN_PAREN="(",CLOSE_PAREN=")",OPEN_PAREN_BRACKET="([",CLOSE_BRACKET_PAREN="])",SEMICOLON=";",DOUBLE_PAREN="()",EQUALS="=",CONTEXT_METHODS=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],CONTEXT_PROPERTIES=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"];const traceArrMax=100;class Context{constructor(canvas){this.canvas=canvas,Global_1$b.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(shape){shape.fillEnabled()&&this._fill(shape)}_fill(shape){}strokeShape(shape){shape.hasStroke()&&this._stroke(shape)}_stroke(shape){}fillStrokeShape(shape){shape.attrs.fillAfterStrokeEnabled?(this.strokeShape(shape),this.fillShape(shape)):(this.fillShape(shape),this.strokeShape(shape))}getTrace(relaxed,rounded){var traceArr=this.traceArr,len=traceArr.length,str="",n,trace,method,args;for(n=0;n<len;n++)trace=traceArr[n],method=trace.method,method?(args=trace.args,str+=method,relaxed?str+=DOUBLE_PAREN:Util_1$7.Util._isArray(args[0])?str+=OPEN_PAREN_BRACKET+args.join(COMMA)+CLOSE_BRACKET_PAREN:(rounded&&(args=args.map(a=>typeof a=="number"?Math.floor(a):a)),str+=OPEN_PAREN+args.join(COMMA)+CLOSE_PAREN)):(str+=trace.property,relaxed||(str+=EQUALS+trace.val)),str+=SEMICOLON;return str}clearTrace(){this.traceArr=[]}_trace(str){var traceArr=this.traceArr,len;traceArr.push(str),len=traceArr.length,len>=traceArrMax&&traceArr.shift()}reset(){var pixelRatio=this.getCanvas().getPixelRatio();this.setTransform(1*pixelRatio,0,0,1*pixelRatio,0,0)}getCanvas(){return this.canvas}clear(bounds){var canvas=this.getCanvas();bounds?this.clearRect(bounds.x||0,bounds.y||0,bounds.width||0,bounds.height||0):this.clearRect(0,0,canvas.getWidth()/canvas.pixelRatio,canvas.getHeight()/canvas.pixelRatio)}_applyLineCap(shape){const lineCap=shape.attrs.lineCap;lineCap&&this.setAttr("lineCap",lineCap)}_applyOpacity(shape){var absOpacity=shape.getAbsoluteOpacity();absOpacity!==1&&this.setAttr("globalAlpha",absOpacity)}_applyLineJoin(shape){const lineJoin=shape.attrs.lineJoin;lineJoin&&this.setAttr("lineJoin",lineJoin)}setAttr(attr,val){this._context[attr]=val}arc(x,y,radius,startAngle,endAngle,counterClockwise){this._context.arc(x,y,radius,startAngle,endAngle,counterClockwise)}arcTo(x1,y1,x2,y2,radius){this._context.arcTo(x1,y1,x2,y2,radius)}beginPath(){this._context.beginPath()}bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x,y){this._context.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x,y)}clearRect(x,y,width,height){this._context.clearRect(x,y,width,height)}clip(...args){this._context.clip.apply(this._context,args)}closePath(){this._context.closePath()}createImageData(width,height){var a=arguments;if(a.length===2)return this._context.createImageData(width,height);if(a.length===1)return this._context.createImageData(width)}createLinearGradient(x0,y0,x1,y1){return this._context.createLinearGradient(x0,y0,x1,y1)}createPattern(image,repetition){return this._context.createPattern(image,repetition)}createRadialGradient(x0,y0,r0,x1,y1,r1){return this._context.createRadialGradient(x0,y0,r0,x1,y1,r1)}drawImage(image,sx,sy,sWidth,sHeight,dx,dy,dWidth,dHeight){var a=arguments,_context=this._context;a.length===3?_context.drawImage(image,sx,sy):a.length===5?_context.drawImage(image,sx,sy,sWidth,sHeight):a.length===9&&_context.drawImage(image,sx,sy,sWidth,sHeight,dx,dy,dWidth,dHeight)}ellipse(x,y,radiusX,radiusY,rotation,startAngle,endAngle,counterclockwise){this._context.ellipse(x,y,radiusX,radiusY,rotation,startAngle,endAngle,counterclockwise)}isPointInPath(x,y,path,fillRule){return path?this._context.isPointInPath(path,x,y,fillRule):this._context.isPointInPath(x,y,fillRule)}fill(...args){this._context.fill.apply(this._context,args)}fillRect(x,y,width,height){this._context.fillRect(x,y,width,height)}strokeRect(x,y,width,height){this._context.strokeRect(x,y,width,height)}fillText(text,x,y,maxWidth){maxWidth?this._context.fillText(text,x,y,maxWidth):this._context.fillText(text,x,y)}measureText(text){return this._context.measureText(text)}getImageData(sx,sy,sw,sh){return this._context.getImageData(sx,sy,sw,sh)}lineTo(x,y){this._context.lineTo(x,y)}moveTo(x,y){this._context.moveTo(x,y)}rect(x,y,width,height){this._context.rect(x,y,width,height)}roundRect(x,y,width,height,radii){this._context.roundRect(x,y,width,height,radii)}putImageData(imageData,dx,dy){this._context.putImageData(imageData,dx,dy)}quadraticCurveTo(cpx,cpy,x,y){this._context.quadraticCurveTo(cpx,cpy,x,y)}restore(){this._context.restore()}rotate(angle){this._context.rotate(angle)}save(){this._context.save()}scale(x,y){this._context.scale(x,y)}setLineDash(segments){this._context.setLineDash?this._context.setLineDash(segments):"mozDash"in this._context?this._context.mozDash=segments:"webkitLineDash"in this._context&&(this._context.webkitLineDash=segments)}getLineDash(){return this._context.getLineDash()}setTransform(a,b,c,d,e,f){this._context.setTransform(a,b,c,d,e,f)}stroke(path2d){path2d?this._context.stroke(path2d):this._context.stroke()}strokeText(text,x,y,maxWidth){this._context.strokeText(text,x,y,maxWidth)}transform(a,b,c,d,e,f){this._context.transform(a,b,c,d,e,f)}translate(x,y){this._context.translate(x,y)}_enableTrace(){var that=this,len=CONTEXT_METHODS.length,origSetter=this.setAttr,n,args,func=function(methodName){var origMethod=that[methodName],ret;that[methodName]=function(){return args=simplifyArray(Array.prototype.slice.call(arguments,0)),ret=origMethod.apply(that,arguments),that._trace({method:methodName,args}),ret}};for(n=0;n<len;n++)func(CONTEXT_METHODS[n]);that.setAttr=function(){origSetter.apply(that,arguments);var prop=arguments[0],val=arguments[1];(prop==="shadowOffsetX"||prop==="shadowOffsetY"||prop==="shadowBlur")&&(val=val/this.canvas.getPixelRatio()),that._trace({property:prop,val})}}_applyGlobalCompositeOperation(node){const op=node.attrs.globalCompositeOperation;var def=!op||op==="source-over";def||this.setAttr("globalCompositeOperation",op)}}Context$1.Context=Context;CONTEXT_PROPERTIES.forEach(function(prop){Object.defineProperty(Context.prototype,prop,{get(){return this._context[prop]},set(val){this._context[prop]=val}})});class SceneContext extends Context{constructor(canvas,{willReadFrequently=!1}={}){super(canvas),this._context=canvas._canvas.getContext("2d",{willReadFrequently})}_fillColor(shape){var fill=shape.fill();this.setAttr("fillStyle",fill),shape._fillFunc(this)}_fillPattern(shape){this.setAttr("fillStyle",shape._getFillPattern()),shape._fillFunc(this)}_fillLinearGradient(shape){var grd=shape._getLinearGradient();grd&&(this.setAttr("fillStyle",grd),shape._fillFunc(this))}_fillRadialGradient(shape){const grd=shape._getRadialGradient();grd&&(this.setAttr("fillStyle",grd),shape._fillFunc(this))}_fill(shape){const hasColor=shape.fill(),fillPriority=shape.getFillPriority();if(hasColor&&fillPriority==="color"){this._fillColor(shape);return}const hasPattern=shape.getFillPatternImage();if(hasPattern&&fillPriority==="pattern"){this._fillPattern(shape);return}const hasLinearGradient=shape.getFillLinearGradientColorStops();if(hasLinearGradient&&fillPriority==="linear-gradient"){this._fillLinearGradient(shape);return}const hasRadialGradient=shape.getFillRadialGradientColorStops();if(hasRadialGradient&&fillPriority==="radial-gradient"){this._fillRadialGradient(shape);return}hasColor?this._fillColor(shape):hasPattern?this._fillPattern(shape):hasLinearGradient?this._fillLinearGradient(shape):hasRadialGradient&&this._fillRadialGradient(shape)}_strokeLinearGradient(shape){const start=shape.getStrokeLinearGradientStartPoint(),end=shape.getStrokeLinearGradientEndPoint(),colorStops=shape.getStrokeLinearGradientColorStops(),grd=this.createLinearGradient(start.x,start.y,end.x,end.y);if(colorStops){for(var n=0;n<colorStops.length;n+=2)grd.addColorStop(colorStops[n],colorStops[n+1]);this.setAttr("strokeStyle",grd)}}_stroke(shape){var dash=shape.dash(),strokeScaleEnabled=shape.getStrokeScaleEnabled();if(shape.hasStroke()){if(!strokeScaleEnabled){this.save();var pixelRatio=this.getCanvas().getPixelRatio();this.setTransform(pixelRatio,0,0,pixelRatio,0,0)}this._applyLineCap(shape),dash&&shape.dashEnabled()&&(this.setLineDash(dash),this.setAttr("lineDashOffset",shape.dashOffset())),this.setAttr("lineWidth",shape.strokeWidth()),shape.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)");var hasLinearGradient=shape.getStrokeLinearGradientColorStops();hasLinearGradient?this._strokeLinearGradient(shape):this.setAttr("strokeStyle",shape.stroke()),shape._strokeFunc(this),strokeScaleEnabled||this.restore()}}_applyShadow(shape){var _a,_b,_c,color=(_a=shape.getShadowRGBA())!==null&&_a!==void 0?_a:"black",blur=(_b=shape.getShadowBlur())!==null&&_b!==void 0?_b:5,offset=(_c=shape.getShadowOffset())!==null&&_c!==void 0?_c:{x:0,y:0},scale=shape.getAbsoluteScale(),ratio=this.canvas.getPixelRatio(),scaleX=scale.x*ratio,scaleY=scale.y*ratio;this.setAttr("shadowColor",color),this.setAttr("shadowBlur",blur*Math.min(Math.abs(scaleX),Math.abs(scaleY))),this.setAttr("shadowOffsetX",offset.x*scaleX),this.setAttr("shadowOffsetY",offset.y*scaleY)}}Context$1.SceneContext=SceneContext;class HitContext extends Context{constructor(canvas){super(canvas),this._context=canvas._canvas.getContext("2d",{willReadFrequently:!0})}_fill(shape){this.save(),this.setAttr("fillStyle",shape.colorKey),shape._fillFuncHit(this),this.restore()}strokeShape(shape){shape.hasHitStroke()&&this._stroke(shape)}_stroke(shape){if(shape.hasHitStroke()){const strokeScaleEnabled=shape.getStrokeScaleEnabled();if(!strokeScaleEnabled){this.save();var pixelRatio=this.getCanvas().getPixelRatio();this.setTransform(pixelRatio,0,0,pixelRatio,0,0)}this._applyLineCap(shape);var hitStrokeWidth=shape.hitStrokeWidth(),strokeWidth=hitStrokeWidth==="auto"?shape.strokeWidth():hitStrokeWidth;this.setAttr("lineWidth",strokeWidth),this.setAttr("strokeStyle",shape.colorKey),shape._strokeFuncHit(this),strokeScaleEnabled||this.restore()}}}Context$1.HitContext=HitContext;Object.defineProperty(Canvas$1,"__esModule",{value:!0});Canvas$1.HitCanvas=Canvas$1.SceneCanvas=Canvas$1.Canvas=void 0;const Util_1$6=Util,Context_1=Context$1,Global_1$a=Global,Factory_1$7=Factory,Validators_1$6=Validators;var _pixelRatio;function getDevicePixelRatio(){if(_pixelRatio)return _pixelRatio;var canvas=Util_1$6.Util.createCanvasElement(),context=canvas.getContext("2d");return _pixelRatio=function(){var devicePixelRatio=Global_1$a.Konva._global.devicePixelRatio||1,backingStoreRatio=context.webkitBackingStorePixelRatio||context.mozBackingStorePixelRatio||context.msBackingStorePixelRatio||context.oBackingStorePixelRatio||context.backingStorePixelRatio||1;return devicePixelRatio/backingStoreRatio}(),Util_1$6.Util.releaseCanvas(canvas),_pixelRatio}class Canvas{constructor(config){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var conf=config||{},pixelRatio=conf.pixelRatio||Global_1$a.Konva.pixelRatio||getDevicePixelRatio();this.pixelRatio=pixelRatio,this._canvas=Util_1$6.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(pixelRatio){var previousRatio=this.pixelRatio;this.pixelRatio=pixelRatio,this.setSize(this.getWidth()/previousRatio,this.getHeight()/previousRatio)}setWidth(width){this.width=this._canvas.width=width*this.pixelRatio,this._canvas.style.width=width+"px";var pixelRatio=this.pixelRatio,_context=this.getContext()._context;_context.scale(pixelRatio,pixelRatio)}setHeight(height){this.height=this._canvas.height=height*this.pixelRatio,this._canvas.style.height=height+"px";var pixelRatio=this.pixelRatio,_context=this.getContext()._context;_context.scale(pixelRatio,pixelRatio)}getWidth(){return this.width}getHeight(){return this.height}setSize(width,height){this.setWidth(width||0),this.setHeight(height||0)}toDataURL(mimeType,quality){try{return this._canvas.toDataURL(mimeType,quality)}catch{try{return this._canvas.toDataURL()}catch(err){return Util_1$6.Util.error("Unable to get data URL. "+err.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}Canvas$1.Canvas=Canvas;Factory_1$7.Factory.addGetterSetter(Canvas,"pixelRatio",void 0,(0,Validators_1$6.getNumberValidator)());class SceneCanvas extends Canvas{constructor(config={width:0,height:0,willReadFrequently:!1}){super(config),this.context=new Context_1.SceneContext(this,{willReadFrequently:config.willReadFrequently}),this.setSize(config.width,config.height)}}Canvas$1.SceneCanvas=SceneCanvas;class HitCanvas extends Canvas{constructor(config={width:0,height:0}){super(config),this.hitCanvas=!0,this.context=new Context_1.HitContext(this),this.setSize(config.width,config.height)}}Canvas$1.HitCanvas=HitCanvas;var DragAndDrop={};(function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.DD=void 0;const Global_12=Global,Util_12=Util;exports.DD={get isDragging(){var flag=!1;return exports.DD._dragElements.forEach(elem=>{elem.dragStatus==="dragging"&&(flag=!0)}),flag},justDragged:!1,get node(){var node;return exports.DD._dragElements.forEach(elem=>{node=elem.node}),node},_dragElements:new Map,_drag(evt){const nodesToFireEvents=[];exports.DD._dragElements.forEach((elem,key)=>{const{node}=elem,stage2=node.getStage();stage2.setPointersPositions(evt),elem.pointerId===void 0&&(elem.pointerId=Util_12.Util._getFirstPointerId(evt));const pos=stage2._changedPointerPositions.find(pos2=>pos2.id===elem.pointerId);if(pos){if(elem.dragStatus!=="dragging"){var dragDistance=node.dragDistance(),distance=Math.max(Math.abs(pos.x-elem.startPointerPos.x),Math.abs(pos.y-elem.startPointerPos.y));if(distance<dragDistance||(node.startDrag({evt}),!node.isDragging()))return}node._setDragPosition(evt,elem),nodesToFireEvents.push(node)}}),nodesToFireEvents.forEach(node=>{node.fire("dragmove",{type:"dragmove",target:node,evt},!0)})},_endDragBefore(evt){const drawNodes=[];exports.DD._dragElements.forEach(elem=>{const{node}=elem,stage2=node.getStage();if(evt&&stage2.setPointersPositions(evt),!stage2._changedPointerPositions.find(pos2=>pos2.id===elem.pointerId))return;(elem.dragStatus==="dragging"||elem.dragStatus==="stopped")&&(exports.DD.justDragged=!0,Global_12.Konva._mouseListenClick=!1,Global_12.Konva._touchListenClick=!1,Global_12.Konva._pointerListenClick=!1,elem.dragStatus="stopped");const drawNode=elem.node.getLayer()||elem.node instanceof Global_12.Konva.Stage&&elem.node;drawNode&&drawNodes.indexOf(drawNode)===-1&&drawNodes.push(drawNode)}),drawNodes.forEach(drawNode=>{drawNode.draw()})},_endDragAfter(evt){exports.DD._dragElements.forEach((elem,key)=>{elem.dragStatus==="stopped"&&elem.node.fire("dragend",{type:"dragend",target:elem.node,evt},!0),elem.dragStatus!=="dragging"&&exports.DD._dragElements.delete(key)})}},Global_12.Konva.isBrowser&&(window.addEventListener("mouseup",exports.DD._endDragBefore,!0),window.addEventListener("touchend",exports.DD._endDragBefore,!0),window.addEventListener("mousemove",exports.DD._drag),window.addEventListener("touchmove",exports.DD._drag),window.addEventListener("mouseup",exports.DD._endDragAfter,!1),window.addEventListener("touchend",exports.DD._endDragAfter,!1))})(DragAndDrop);Object.defineProperty(Node$1,"__esModule",{value:!0});Node$1.Node=void 0;const Util_1$5=Util,Factory_1$6=Factory,Canvas_1$1=Canvas$1,Global_1$9=Global,DragAndDrop_1=DragAndDrop,Validators_1$5=Validators;var ABSOLUTE_OPACITY="absoluteOpacity",ALL_LISTENERS="allEventListeners",ABSOLUTE_TRANSFORM="absoluteTransform",ABSOLUTE_SCALE="absoluteScale",CANVAS="canvas",CHANGE="Change",CHILDREN="children",KONVA="konva",LISTENING="listening",MOUSEENTER="mouseenter",MOUSELEAVE="mouseleave",SET="set",SHAPE="Shape",SPACE=" ",STAGE="stage",TRANSFORM="transform",UPPER_STAGE="Stage",VISIBLE="visible",TRANSFORM_CHANGE_STR=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(SPACE);let idCounter=1;class Node{constructor(config){this._id=idCounter++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(config),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(attr){(attr===TRANSFORM||attr===ABSOLUTE_TRANSFORM)&&this._cache.get(attr)?this._cache.get(attr).dirty=!0:attr?this._cache.delete(attr):this._cache.clear()}_getCache(attr,privateGetter){var cache=this._cache.get(attr),isTransform=attr===TRANSFORM||attr===ABSOLUTE_TRANSFORM,invalid=cache===void 0||isTransform&&cache.dirty===!0;return invalid&&(cache=privateGetter.call(this),this._cache.set(attr,cache)),cache}_calculate(name2,deps,getter){if(!this._attachedDepsListeners.get(name2)){const depsString=deps.map(dep=>dep+"Change.konva").join(SPACE);this.on(depsString,()=>{this._clearCache(name2)}),this._attachedDepsListeners.set(name2,!0)}return this._getCache(name2,getter)}_getCanvasCache(){return this._cache.get(CANVAS)}_clearSelfAndDescendantCache(attr){this._clearCache(attr),attr===ABSOLUTE_TRANSFORM&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(CANVAS)){const{scene,filter,hit}=this._cache.get(CANVAS);Util_1$5.Util.releaseCanvas(scene,filter,hit),this._cache.delete(CANVAS)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(config){var conf=config||{},rect={};(conf.x===void 0||conf.y===void 0||conf.width===void 0||conf.height===void 0)&&(rect=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));var width=Math.ceil(conf.width||rect.width),height=Math.ceil(conf.height||rect.height),pixelRatio=conf.pixelRatio,x=conf.x===void 0?Math.floor(rect.x):conf.x,y=conf.y===void 0?Math.floor(rect.y):conf.y,offset=conf.offset||0,drawBorder=conf.drawBorder||!1,hitCanvasPixelRatio=conf.hitCanvasPixelRatio||1;if(!width||!height){Util_1$5.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const extraPaddingX=Math.abs(Math.round(rect.x)-x)>.5?1:0,extraPaddingY=Math.abs(Math.round(rect.y)-y)>.5?1:0;width+=offset*2+extraPaddingX,height+=offset*2+extraPaddingY,x-=offset,y-=offset;var cachedSceneCanvas=new Canvas_1$1.SceneCanvas({pixelRatio,width,height}),cachedFilterCanvas=new Canvas_1$1.SceneCanvas({pixelRatio,width:0,height:0,willReadFrequently:!0}),cachedHitCanvas=new Canvas_1$1.HitCanvas({pixelRatio:hitCanvasPixelRatio,width,height}),sceneContext=cachedSceneCanvas.getContext(),hitContext=cachedHitCanvas.getContext();return cachedHitCanvas.isCache=!0,cachedSceneCanvas.isCache=!0,this._cache.delete(CANVAS),this._filterUpToDate=!1,conf.imageSmoothingEnabled===!1&&(cachedSceneCanvas.getContext()._context.imageSmoothingEnabled=!1,cachedFilterCanvas.getContext()._context.imageSmoothingEnabled=!1),sceneContext.save(),hitContext.save(),sceneContext.translate(-x,-y),hitContext.translate(-x,-y),this._isUnderCache=!0,this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY),this._clearSelfAndDescendantCache(ABSOLUTE_SCALE),this.drawScene(cachedSceneCanvas,this),this.drawHit(cachedHitCanvas,this),this._isUnderCache=!1,sceneContext.restore(),hitContext.restore(),drawBorder&&(sceneContext.save(),sceneContext.beginPath(),sceneContext.rect(0,0,width,height),sceneContext.closePath(),sceneContext.setAttr("strokeStyle","red"),sceneContext.setAttr("lineWidth",5),sceneContext.stroke(),sceneContext.restore()),this._cache.set(CANVAS,{scene:cachedSceneCanvas,filter:cachedFilterCanvas,hit:cachedHitCanvas,x,y}),this._requestDraw(),this}isCached(){return this._cache.has(CANVAS)}getClientRect(config){throw new Error('abstract "getClientRect" method call')}_transformedRect(rect,top){var points=[{x:rect.x,y:rect.y},{x:rect.x+rect.width,y:rect.y},{x:rect.x+rect.width,y:rect.y+rect.height},{x:rect.x,y:rect.y+rect.height}],minX=1/0,minY=1/0,maxX=-1/0,maxY=-1/0,trans=this.getAbsoluteTransform(top);return points.forEach(function(point){var transformed=trans.point(point);minX===void 0&&(minX=maxX=transformed.x,minY=maxY=transformed.y),minX=Math.min(minX,transformed.x),minY=Math.min(minY,transformed.y),maxX=Math.max(maxX,transformed.x),maxY=Math.max(maxY,transformed.y)}),{x:minX,y:minY,width:maxX-minX,height:maxY-minY}}_drawCachedSceneCanvas(context){context.save(),context._applyOpacity(this),context._applyGlobalCompositeOperation(this);const canvasCache=this._getCanvasCache();context.translate(canvasCache.x,canvasCache.y);var cacheCanvas=this._getCachedSceneCanvas(),ratio=cacheCanvas.pixelRatio;context.drawImage(cacheCanvas._canvas,0,0,cacheCanvas.width/ratio,cacheCanvas.height/ratio),context.restore()}_drawCachedHitCanvas(context){var canvasCache=this._getCanvasCache(),hitCanvas=canvasCache.hit;context.save(),context.translate(canvasCache.x,canvasCache.y),context.drawImage(hitCanvas._canvas,0,0,hitCanvas.width/hitCanvas.pixelRatio,hitCanvas.height/hitCanvas.pixelRatio),context.restore()}_getCachedSceneCanvas(){var filters=this.filters(),cachedCanvas=this._getCanvasCache(),sceneCanvas=cachedCanvas.scene,filterCanvas=cachedCanvas.filter,filterContext=filterCanvas.getContext(),len,imageData,n,filter;if(filters){if(!this._filterUpToDate){var ratio=sceneCanvas.pixelRatio;filterCanvas.setSize(sceneCanvas.width/sceneCanvas.pixelRatio,sceneCanvas.height/sceneCanvas.pixelRatio);try{for(len=filters.length,filterContext.clear(),filterContext.drawImage(sceneCanvas._canvas,0,0,sceneCanvas.getWidth()/ratio,sceneCanvas.getHeight()/ratio),imageData=filterContext.getImageData(0,0,filterCanvas.getWidth(),filterCanvas.getHeight()),n=0;n<len;n++){if(filter=filters[n],typeof filter!="function"){Util_1$5.Util.error("Filter should be type of function, but got "+typeof filter+" instead. Please check correct filters");continue}filter.call(this,imageData),filterContext.putImageData(imageData,0,0)}}catch(e){Util_1$5.Util.error("Unable to apply filter. "+e.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return filterCanvas}return sceneCanvas}on(evtStr,handler){if(this._cache&&this._cache.delete(ALL_LISTENERS),arguments.length===3)return this._delegate.apply(this,arguments);var events=evtStr.split(SPACE),len=events.length,n,event,parts,baseEvent,name2;for(n=0;n<len;n++)event=events[n],parts=event.split("."),baseEvent=parts[0],name2=parts[1]||"",this.eventListeners[baseEvent]||(this.eventListeners[baseEvent]=[]),this.eventListeners[baseEvent].push({name:name2,handler});return this}off(evtStr,callback){var events=(evtStr||"").split(SPACE),len=events.length,n,t,event,parts,baseEvent,name2;if(this._cache&&this._cache.delete(ALL_LISTENERS),!evtStr)for(t in this.eventListeners)this._off(t);for(n=0;n<len;n++)if(event=events[n],parts=event.split("."),baseEvent=parts[0],name2=parts[1],baseEvent)this.eventListeners[baseEvent]&&this._off(baseEvent,name2,callback);else for(t in this.eventListeners)this._off(t,name2,callback);return this}dispatchEvent(evt){var e={target:this,type:evt.type,evt};return this.fire(evt.type,e),this}addEventListener(type,handler){return this.on(type,function(evt){handler.call(this,evt.evt)}),this}removeEventListener(type){return this.off(type),this}_delegate(event,selector,handler){var stopNode=this;this.on(event,function(evt){for(var targets=evt.target.findAncestors(selector,!0,stopNode),i=0;i<targets.length;i++)evt=Util_1$5.Util.cloneObject(evt),evt.currentTarget=targets[i],handler.call(targets[i],evt)})}remove(){return this.isDragging()&&this.stopDrag(),DragAndDrop_1.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM),this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY),this._clearSelfAndDescendantCache(ABSOLUTE_SCALE),this._clearSelfAndDescendantCache(STAGE),this._clearSelfAndDescendantCache(VISIBLE),this._clearSelfAndDescendantCache(LISTENING)}_remove(){this._clearCaches();var parent=this.getParent();parent&&parent.children&&(parent.children.splice(this.index,1),parent._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(attr){var method="get"+Util_1$5.Util._capitalize(attr);return Util_1$5.Util._isFunction(this[method])?this[method]():this.attrs[attr]}getAncestors(){for(var parent=this.getParent(),ancestors=[];parent;)ancestors.push(parent),parent=parent.getParent();return ancestors}getAttrs(){return this.attrs||{}}setAttrs(config){return this._batchTransformChanges(()=>{var key,method;if(!config)return this;for(key in config)key!==CHILDREN&&(method=SET+Util_1$5.Util._capitalize(key),Util_1$5.Util._isFunction(this[method])?this[method](config[key]):this._setAttr(key,config[key]))}),this}isListening(){return this._getCache(LISTENING,this._isListening)}_isListening(relativeTo){if(!this.listening())return!1;const parent=this.getParent();return parent&&parent!==relativeTo&&this!==relativeTo?parent._isListening(relativeTo):!0}isVisible(){return this._getCache(VISIBLE,this._isVisible)}_isVisible(relativeTo){if(!this.visible())return!1;const parent=this.getParent();return parent&&parent!==relativeTo&&this!==relativeTo?parent._isVisible(relativeTo):!0}shouldDrawHit(top,skipDragCheck=!1){if(top)return this._isVisible(top)&&this._isListening(top);var layer=this.getLayer(),layerUnderDrag=!1;DragAndDrop_1.DD._dragElements.forEach(elem=>{elem.dragStatus==="dragging"&&(elem.node.nodeType==="Stage"||elem.node.getLayer()===layer)&&(layerUnderDrag=!0)});var dragSkip=!skipDragCheck&&!Global_1$9.Konva.hitOnDragEnabled&&(layerUnderDrag||Global_1$9.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!dragSkip}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){var depth=this.getDepth(),that=this,index=0,nodes,len,n,child;function addChildren(children){for(nodes=[],len=children.length,n=0;n<len;n++)child=children[n],index++,child.nodeType!==SHAPE&&(nodes=nodes.concat(child.getChildren().slice())),child._id===that._id&&(n=len);nodes.length>0&&nodes[0].getDepth()<=depth&&addChildren(nodes)}const stage2=this.getStage();return that.nodeType!==UPPER_STAGE&&stage2&&addChildren(stage2.getChildren()),index}getDepth(){for(var depth=0,parent=this.parent;parent;)depth++,parent=parent.parent;return depth}_batchTransformChanges(func){this._batchingTransformChange=!0,func(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(TRANSFORM),this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM)),this._needClearTransformCache=!1}setPosition(pos){return this._batchTransformChanges(()=>{this.x(pos.x),this.y(pos.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const stage2=this.getStage();if(!stage2)return null;var pos=stage2.getPointerPosition();if(!pos)return null;var transform=this.getAbsoluteTransform().copy();return transform.invert(),transform.point(pos)}getAbsolutePosition(top){let haveCachedParent=!1,parent=this.parent;for(;parent;){if(parent.isCached()){haveCachedParent=!0;break}parent=parent.parent}haveCachedParent&&!top&&(top=!0);var absoluteMatrix=this.getAbsoluteTransform(top).getMatrix(),absoluteTransform=new Util_1$5.Transform,offset=this.offset();return absoluteTransform.m=absoluteMatrix.slice(),absoluteTransform.translate(offset.x,offset.y),absoluteTransform.getTranslation()}setAbsolutePosition(pos){const{x,y,...origTrans}=this._clearTransform();this.attrs.x=x,this.attrs.y=y,this._clearCache(TRANSFORM);var it=this._getAbsoluteTransform().copy();return it.invert(),it.translate(pos.x,pos.y),pos={x:this.attrs.x+it.getTranslation().x,y:this.attrs.y+it.getTranslation().y},this._setTransform(origTrans),this.setPosition({x:pos.x,y:pos.y}),this._clearCache(TRANSFORM),this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM),this}_setTransform(trans){var key;for(key in trans)this.attrs[key]=trans[key]}_clearTransform(){var trans={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,trans}move(change){var changeX=change.x,changeY=change.y,x=this.x(),y=this.y();return changeX!==void 0&&(x+=changeX),changeY!==void 0&&(y+=changeY),this.setPosition({x,y}),this}_eachAncestorReverse(func,top){var family=[],parent=this.getParent(),len,n;if(!(top&&top._id===this._id)){for(family.unshift(this);parent&&(!top||parent._id!==top._id);)family.unshift(parent),parent=parent.parent;for(len=family.length,n=0;n<len;n++)func(family[n])}}rotate(theta){return this.rotation(this.rotation()+theta),this}moveToTop(){if(!this.parent)return Util_1$5.Util.warn("Node has no parent. moveToTop function is ignored."),!1;var index=this.index,len=this.parent.getChildren().length;return index<len-1?(this.parent.children.splice(index,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return Util_1$5.Util.warn("Node has no parent. moveUp function is ignored."),!1;var index=this.index,len=this.parent.getChildren().length;return index<len-1?(this.parent.children.splice(index,1),this.parent.children.splice(index+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return Util_1$5.Util.warn("Node has no parent. moveDown function is ignored."),!1;var index=this.index;return index>0?(this.parent.children.splice(index,1),this.parent.children.splice(index-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return Util_1$5.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;var index=this.index;return index>0?(this.parent.children.splice(index,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(zIndex){if(!this.parent)return Util_1$5.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(zIndex<0||zIndex>=this.parent.children.length)&&Util_1$5.Util.warn("Unexpected value "+zIndex+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var index=this.index;return this.parent.children.splice(index,1),this.parent.children.splice(zIndex,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(ABSOLUTE_OPACITY,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){var absOpacity=this.opacity(),parent=this.getParent();return parent&&!parent._isUnderCache&&(absOpacity*=parent.getAbsoluteOpacity()),absOpacity}moveTo(newContainer){return this.getParent()!==newContainer&&(this._remove(),newContainer.add(this)),this}toObject(){var attrs=this.getAttrs(),key,val,getter,defaultValue,nonPlainObject;const obj={attrs:{},className:this.getClassName()};for(key in attrs)val=attrs[key],nonPlainObject=Util_1$5.Util.isObject(val)&&!Util_1$5.Util._isPlainObject(val)&&!Util_1$5.Util._isArray(val),!nonPlainObject&&(getter=typeof this[key]=="function"&&this[key],delete attrs[key],defaultValue=getter?getter.call(this):null,attrs[key]=val,defaultValue!==val&&(obj.attrs[key]=val));return Util_1$5.Util._prepareToStringify(obj)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(selector,includeSelf,stopNode){var res=[];includeSelf&&this._isMatch(selector)&&res.push(this);for(var ancestor=this.parent;ancestor;){if(ancestor===stopNode)return res;ancestor._isMatch(selector)&&res.push(ancestor),ancestor=ancestor.parent}return res}isAncestorOf(node){return!1}findAncestor(selector,includeSelf,stopNode){return this.findAncestors(selector,includeSelf,stopNode)[0]}_isMatch(selector){if(!selector)return!1;if(typeof selector=="function")return selector(this);var selectorArr=selector.replace(/ /g,"").split(","),len=selectorArr.length,n,sel;for(n=0;n<len;n++)if(sel=selectorArr[n],Util_1$5.Util.isValidSelector(sel)||(Util_1$5.Util.warn('Selector "'+sel+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),Util_1$5.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),Util_1$5.Util.warn("Konva is awesome, right?")),sel.charAt(0)==="#"){if(this.id()===sel.slice(1))return!0}else if(sel.charAt(0)==="."){if(this.hasName(sel.slice(1)))return!0}else if(this.className===sel||this.nodeType===sel)return!0;return!1}getLayer(){var parent=this.getParent();return parent?parent.getLayer():null}getStage(){return this._getCache(STAGE,this._getStage)}_getStage(){var parent=this.getParent();return parent?parent.getStage():null}fire(eventType,evt={},bubble){return evt.target=evt.target||this,bubble?this._fireAndBubble(eventType,evt):this._fire(eventType,evt),this}getAbsoluteTransform(top){return top?this._getAbsoluteTransform(top):this._getCache(ABSOLUTE_TRANSFORM,this._getAbsoluteTransform)}_getAbsoluteTransform(top){var at;if(top)return at=new Util_1$5.Transform,this._eachAncestorReverse(function(node){var transformsEnabled2=node.transformsEnabled();transformsEnabled2==="all"?at.multiply(node.getTransform()):transformsEnabled2==="position"&&at.translate(node.x()-node.offsetX(),node.y()-node.offsetY())},top),at;at=this._cache.get(ABSOLUTE_TRANSFORM)||new Util_1$5.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(at):at.reset();var transformsEnabled=this.transformsEnabled();if(transformsEnabled==="all")at.multiply(this.getTransform());else if(transformsEnabled==="position"){const x=this.attrs.x||0,y=this.attrs.y||0,offsetX=this.attrs.offsetX||0,offsetY=this.attrs.offsetY||0;at.translate(x-offsetX,y-offsetY)}return at.dirty=!1,at}getAbsoluteScale(top){for(var parent=this;parent;)parent._isUnderCache&&(top=parent),parent=parent.getParent();const attrs=this.getAbsoluteTransform(top).decompose();return{x:attrs.scaleX,y:attrs.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(TRANSFORM,this._getTransform)}_getTransform(){var _a,_b,m=this._cache.get(TRANSFORM)||new Util_1$5.Transform;m.reset();var x=this.x(),y=this.y(),rotation=Global_1$9.Konva.getAngle(this.rotation()),scaleX=(_a=this.attrs.scaleX)!==null&&_a!==void 0?_a:1,scaleY=(_b=this.attrs.scaleY)!==null&&_b!==void 0?_b:1,skewX=this.attrs.skewX||0,skewY=this.attrs.skewY||0,offsetX=this.attrs.offsetX||0,offsetY=this.attrs.offsetY||0;return(x!==0||y!==0)&&m.translate(x,y),rotation!==0&&m.rotate(rotation),(skewX!==0||skewY!==0)&&m.skew(skewX,skewY),(scaleX!==1||scaleY!==1)&&m.scale(scaleX,scaleY),(offsetX!==0||offsetY!==0)&&m.translate(-1*offsetX,-1*offsetY),m.dirty=!1,m}clone(obj){var attrs=Util_1$5.Util.cloneObject(this.attrs),key,allListeners,len,n,listener;for(key in obj)attrs[key]=obj[key];var node=new this.constructor(attrs);for(key in this.eventListeners)for(allListeners=this.eventListeners[key],len=allListeners.length,n=0;n<len;n++)listener=allListeners[n],listener.name.indexOf(KONVA)<0&&(node.eventListeners[key]||(node.eventListeners[key]=[]),node.eventListeners[key].push(listener));return node}_toKonvaCanvas(config){config=config||{};var box=this.getClientRect(),stage2=this.getStage(),x=config.x!==void 0?config.x:Math.floor(box.x),y=config.y!==void 0?config.y:Math.floor(box.y),pixelRatio=config.pixelRatio||1,canvas=new Canvas_1$1.SceneCanvas({width:config.width||Math.ceil(box.width)||(stage2?stage2.width():0),height:config.height||Math.ceil(box.height)||(stage2?stage2.height():0),pixelRatio}),context=canvas.getContext();const bufferCanvas=new Canvas_1$1.SceneCanvas({width:canvas.width/canvas.pixelRatio+Math.abs(x),height:canvas.height/canvas.pixelRatio+Math.abs(y),pixelRatio:canvas.pixelRatio});return config.imageSmoothingEnabled===!1&&(context._context.imageSmoothingEnabled=!1),context.save(),(x||y)&&context.translate(-1*x,-1*y),this.drawScene(canvas,void 0,bufferCanvas),context.restore(),canvas}toCanvas(config){return this._toKonvaCanvas(config)._canvas}toDataURL(config){config=config||{};var mimeType=config.mimeType||null,quality=config.quality||null,url=this._toKonvaCanvas(config).toDataURL(mimeType,quality);return config.callback&&config.callback(url),url}toImage(config){return new Promise((resolve,reject)=>{try{const callback=config==null?void 0:config.callback;callback&&delete config.callback,Util_1$5.Util._urlToImage(this.toDataURL(config),function(img){resolve(img),callback==null||callback(img)})}catch(err){reject(err)}})}toBlob(config){return new Promise((resolve,reject)=>{try{const callback=config==null?void 0:config.callback;callback&&delete config.callback,this.toCanvas(config).toBlob(blob=>{resolve(blob),callback==null||callback(blob)},config==null?void 0:config.mimeType,config==null?void 0:config.quality)}catch(err){reject(err)}})}setSize(size){return this.width(size.width),this.height(size.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Global_1$9.Konva.dragDistance}_off(type,name2,callback){var evtListeners=this.eventListeners[type],i,evtName,handler;for(i=0;i<evtListeners.length;i++)if(evtName=evtListeners[i].name,handler=evtListeners[i].handler,(evtName!=="konva"||name2==="konva")&&(!name2||evtName===name2)&&(!callback||callback===handler)){if(evtListeners.splice(i,1),evtListeners.length===0){delete this.eventListeners[type];break}i--}}_fireChangeEvent(attr,oldVal,newVal){this._fire(attr+CHANGE,{oldVal,newVal})}addName(name2){if(!this.hasName(name2)){var oldName=this.name(),newName=oldName?oldName+" "+name2:name2;this.name(newName)}return this}hasName(name2){if(!name2)return!1;const fullName=this.name();if(!fullName)return!1;var names=(fullName||"").split(/\s/g);return names.indexOf(name2)!==-1}removeName(name2){var names=(this.name()||"").split(/\s/g),index=names.indexOf(name2);return index!==-1&&(names.splice(index,1),this.name(names.join(" "))),this}setAttr(attr,val){var func=this[SET+Util_1$5.Util._capitalize(attr)];return Util_1$5.Util._isFunction(func)?func.call(this,val):this._setAttr(attr,val),this}_requestDraw(){if(Global_1$9.Konva.autoDrawEnabled){const drawNode=this.getLayer()||this.getStage();drawNode==null||drawNode.batchDraw()}}_setAttr(key,val){var oldVal=this.attrs[key];oldVal===val&&!Util_1$5.Util.isObject(val)||(val==null?delete this.attrs[key]:this.attrs[key]=val,this._shouldFireChangeEvents&&this._fireChangeEvent(key,oldVal,val),this._requestDraw())}_setComponentAttr(key,component,val){var oldVal;val!==void 0&&(oldVal=this.attrs[key],oldVal||(this.attrs[key]=this.getAttr(key)),this.attrs[key][component]=val,this._fireChangeEvent(key,oldVal,val))}_fireAndBubble(eventType,evt,compareShape){evt&&this.nodeType===SHAPE&&(evt.target=this);var shouldStop=(eventType===MOUSEENTER||eventType===MOUSELEAVE)&&(compareShape&&(this===compareShape||this.isAncestorOf&&this.isAncestorOf(compareShape))||this.nodeType==="Stage"&&!compareShape);if(!shouldStop){this._fire(eventType,evt);var stopBubble=(eventType===MOUSEENTER||eventType===MOUSELEAVE)&&compareShape&&compareShape.isAncestorOf&&compareShape.isAncestorOf(this)&&!compareShape.isAncestorOf(this.parent);(evt&&!evt.cancelBubble||!evt)&&this.parent&&this.parent.isListening()&&!stopBubble&&(compareShape&&compareShape.parent?this._fireAndBubble.call(this.parent,eventType,evt,compareShape):this._fireAndBubble.call(this.parent,eventType,evt))}}_getProtoListeners(eventType){var _a,_b,_c;const allListeners=(_a=this._cache.get(ALL_LISTENERS))!==null&&_a!==void 0?_a:{};let events=allListeners==null?void 0:allListeners[eventType];if(events===void 0){events=[];let obj=Object.getPrototypeOf(this);for(;obj;){const hierarchyEvents=(_c=(_b=obj.eventListeners)===null||_b===void 0?void 0:_b[eventType])!==null&&_c!==void 0?_c:[];events.push(...hierarchyEvents),obj=Object.getPrototypeOf(obj)}allListeners[eventType]=events,this._cache.set(ALL_LISTENERS,allListeners)}return events}_fire(eventType,evt){evt=evt||{},evt.currentTarget=this,evt.type=eventType;const topListeners=this._getProtoListeners(eventType);if(topListeners)for(var i=0;i<topListeners.length;i++)topListeners[i].handler.call(this,evt);const selfListeners=this.eventListeners[eventType];if(selfListeners)for(var i=0;i<selfListeners.length;i++)selfListeners[i].handler.call(this,evt)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(evt){var pointerId=evt?evt.pointerId:void 0,stage2=this.getStage(),ap=this.getAbsolutePosition();if(stage2){var pos=stage2._getPointerById(pointerId)||stage2._changedPointerPositions[0]||ap;DragAndDrop_1.DD._dragElements.set(this._id,{node:this,startPointerPos:pos,offset:{x:pos.x-ap.x,y:pos.y-ap.y},dragStatus:"ready",pointerId})}}startDrag(evt,bubbleEvent=!0){DragAndDrop_1.DD._dragElements.has(this._id)||this._createDragElement(evt);const elem=DragAndDrop_1.DD._dragElements.get(this._id);elem.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:evt&&evt.evt},bubbleEvent)}_setDragPosition(evt,elem){const pos=this.getStage()._getPointerById(elem.pointerId);if(pos){var newNodePos={x:pos.x-elem.offset.x,y:pos.y-elem.offset.y},dbf=this.dragBoundFunc();if(dbf!==void 0){const bounded=dbf.call(this,newNodePos,evt);bounded?newNodePos=bounded:Util_1$5.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==newNodePos.x||this._lastPos.y!==newNodePos.y)&&(this.setAbsolutePosition(newNodePos),this._requestDraw()),this._lastPos=newNodePos}}stopDrag(evt){const elem=DragAndDrop_1.DD._dragElements.get(this._id);elem&&(elem.dragStatus="stopped"),DragAndDrop_1.DD._endDragBefore(evt),DragAndDrop_1.DD._endDragAfter(evt)}setDraggable(draggable){this._setAttr("draggable",draggable),this._dragChange()}isDragging(){const elem=DragAndDrop_1.DD._dragElements.get(this._id);return elem?elem.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(evt){var shouldCheckButton=evt.evt.button!==void 0,canDrag=!shouldCheckButton||Global_1$9.Konva.dragButtons.indexOf(evt.evt.button)>=0;if(canDrag&&!this.isDragging()){var hasDraggingChild=!1;DragAndDrop_1.DD._dragElements.forEach(elem=>{this.isAncestorOf(elem.node)&&(hasDraggingChild=!0)}),hasDraggingChild||this._createDragElement(evt)}})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var stage2=this.getStage();if(!stage2)return;const dragElement=DragAndDrop_1.DD._dragElements.get(this._id),isDragging=dragElement&&dragElement.dragStatus==="dragging",isReady=dragElement&&dragElement.dragStatus==="ready";isDragging?this.stopDrag():isReady&&DragAndDrop_1.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(margin={x:0,y:0}){const stage2=this.getStage();if(!stage2)return!1;const screenRect={x:-margin.x,y:-margin.y,width:stage2.width()+2*margin.x,height:stage2.height()+2*margin.y};return Util_1$5.Util.haveIntersection(screenRect,this.getClientRect())}static create(data,container){return Util_1$5.Util._isString(data)&&(data=JSON.parse(data)),this._createNode(data,container)}static _createNode(obj,container){var className=Node.prototype.getClassName.call(obj),children=obj.children,no,len,n;container&&(obj.attrs.container=container),Global_1$9.Konva[className]||(Util_1$5.Util.warn('Can not find a node with class name "'+className+'". Fallback to "Shape".'),className="Shape");const Class=Global_1$9.Konva[className];if(no=new Class(obj.attrs),children)for(len=children.length,n=0;n<len;n++)no.add(Node._createNode(children[n]));return no}}Node$1.Node=Node;Node.prototype.nodeType="Node";Node.prototype._attrsAffectingSize=[];Node.prototype.eventListeners={};Node.prototype.on.call(Node.prototype,TRANSFORM_CHANGE_STR,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(TRANSFORM),this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM)});Node.prototype.on.call(Node.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(VISIBLE)});Node.prototype.on.call(Node.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(LISTENING)});Node.prototype.on.call(Node.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY)});const addGetterSetter=Factory_1$6.Factory.addGetterSetter;addGetterSetter(Node,"zIndex");addGetterSetter(Node,"absolutePosition");addGetterSetter(Node,"position");addGetterSetter(Node,"x",0,(0,Validators_1$5.getNumberValidator)());addGetterSetter(Node,"y",0,(0,Validators_1$5.getNumberValidator)());addGetterSetter(Node,"globalCompositeOperation","source-over",(0,Validators_1$5.getStringValidator)());addGetterSetter(Node,"opacity",1,(0,Validators_1$5.getNumberValidator)());addGetterSetter(Node,"name","",(0,Validators_1$5.getStringValidator)());addGetterSetter(Node,"id","",(0,Validators_1$5.getStringValidator)());addGetterSetter(Node,"rotation",0,(0,Validators_1$5.getNumberValidator)());Factory_1$6.Factory.addComponentsGetterSetter(Node,"scale",["x","y"]);addGetterSetter(Node,"scaleX",1,(0,Validators_1$5.getNumberValidator)());addGetterSetter(Node,"scaleY",1,(0,Validators_1$5.getNumberValidator)());Factory_1$6.Factory.addComponentsGetterSetter(Node,"skew",["x","y"]);addGetterSetter(Node,"skewX",0,(0,Validators_1$5.getNumberValidator)());addGetterSetter(Node,"skewY",0,(0,Validators_1$5.getNumberValidator)());Factory_1$6.Factory.addComponentsGetterSetter(Node,"offset",["x","y"]);addGetterSetter(Node,"offsetX",0,(0,Validators_1$5.getNumberValidator)());addGetterSetter(Node,"offsetY",0,(0,Validators_1$5.getNumberValidator)());addGetterSetter(Node,"dragDistance",null,(0,Validators_1$5.getNumberValidator)());addGetterSetter(Node,"width",0,(0,Validators_1$5.getNumberValidator)());addGetterSetter(Node,"height",0,(0,Validators_1$5.getNumberValidator)());addGetterSetter(Node,"listening",!0,(0,Validators_1$5.getBooleanValidator)());addGetterSetter(Node,"preventDefault",!0,(0,Validators_1$5.getBooleanValidator)());addGetterSetter(Node,"filters",null,function(val){return this._filterUpToDate=!1,val});addGetterSetter(Node,"visible",!0,(0,Validators_1$5.getBooleanValidator)());addGetterSetter(Node,"transformsEnabled","all",(0,Validators_1$5.getStringValidator)());addGetterSetter(Node,"size");addGetterSetter(Node,"dragBoundFunc");addGetterSetter(Node,"draggable",!1,(0,Validators_1$5.getBooleanValidator)());Factory_1$6.Factory.backCompat(Node,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var Container$1={};Object.defineProperty(Container$1,"__esModule",{value:!0});Container$1.Container=void 0;const Factory_1$5=Factory,Node_1$1=Node$1,Validators_1$4=Validators;class Container extends Node_1$1.Node{constructor(){super(...arguments),this.children=[]}getChildren(filterFunc){if(!filterFunc)return this.children||[];const children=this.children||[];var results=[];return children.forEach(function(child){filterFunc(child)&&results.push(child)}),results}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(child=>{child.parent=null,child.index=0,child.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(child=>{child.parent=null,child.index=0,child.destroy()}),this.children=[],this._requestDraw(),this}add(...children){if(children.length===0)return this;if(children.length>1){for(var i=0;i<children.length;i++)this.add(children[i]);return this}const child=children[0];return child.getParent()?(child.moveTo(this),this):(this._validateAdd(child),child.index=this.getChildren().length,child.parent=this,child._clearCaches(),this.getChildren().push(child),this._fire("add",{child}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(selector){return this._generalFind(selector,!1)}findOne(selector){var result=this._generalFind(selector,!0);return result.length>0?result[0]:void 0}_generalFind(selector,findOne){var retArr=[];return this._descendants(node=>{const valid=node._isMatch(selector);return valid&&retArr.push(node),!!(valid&&findOne)}),retArr}_descendants(fn){let shouldStop=!1;const children=this.getChildren();for(const child of children){if(shouldStop=fn(child),shouldStop)return!0;if(child.hasChildren()&&(shouldStop=child._descendants(fn),shouldStop))return!0}return!1}toObject(){var obj=Node_1$1.Node.prototype.toObject.call(this);return obj.children=[],this.getChildren().forEach(child=>{obj.children.push(child.toObject())}),obj}isAncestorOf(node){for(var parent=node.getParent();parent;){if(parent._id===this._id)return!0;parent=parent.getParent()}return!1}clone(obj){var node=Node_1$1.Node.prototype.clone.call(this,obj);return this.getChildren().forEach(function(no){node.add(no.clone())}),node}getAllIntersections(pos){var arr=[];return this.find("Shape").forEach(shape=>{shape.isVisible()&&shape.intersects(pos)&&arr.push(shape)}),arr}_clearSelfAndDescendantCache(attr){var _a;super._clearSelfAndDescendantCache(attr),!this.isCached()&&((_a=this.children)===null||_a===void 0||_a.forEach(function(node){node._clearSelfAndDescendantCache(attr)}))}_setChildrenIndices(){var _a;(_a=this.children)===null||_a===void 0||_a.forEach(function(child,n){child.index=n}),this._requestDraw()}drawScene(can,top,bufferCanvas){var layer=this.getLayer(),canvas=can||layer&&layer.getCanvas(),context=canvas&&canvas.getContext(),cachedCanvas=this._getCanvasCache(),cachedSceneCanvas=cachedCanvas&&cachedCanvas.scene,caching=canvas&&canvas.isCache;if(!this.isVisible()&&!caching)return this;if(cachedSceneCanvas){context.save();var m=this.getAbsoluteTransform(top).getMatrix();context.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._drawCachedSceneCanvas(context),context.restore()}else this._drawChildren("drawScene",canvas,top,bufferCanvas);return this}drawHit(can,top){if(!this.shouldDrawHit(top))return this;var layer=this.getLayer(),canvas=can||layer&&layer.hitCanvas,context=canvas&&canvas.getContext(),cachedCanvas=this._getCanvasCache(),cachedHitCanvas=cachedCanvas&&cachedCanvas.hit;if(cachedHitCanvas){context.save();var m=this.getAbsoluteTransform(top).getMatrix();context.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._drawCachedHitCanvas(context),context.restore()}else this._drawChildren("drawHit",canvas,top);return this}_drawChildren(drawMethod,canvas,top,bufferCanvas){var _a,context=canvas&&canvas.getContext(),clipWidth=this.clipWidth(),clipHeight=this.clipHeight(),clipFunc=this.clipFunc(),hasClip=typeof clipWidth=="number"&&typeof clipHeight=="number"||clipFunc;const selfCache=top===this;if(hasClip){context.save();var transform=this.getAbsoluteTransform(top),m=transform.getMatrix();context.transform(m[0],m[1],m[2],m[3],m[4],m[5]),context.beginPath();let clipArgs;if(clipFunc)clipArgs=clipFunc.call(this,context,this);else{var clipX=this.clipX(),clipY=this.clipY();context.rect(clipX||0,clipY||0,clipWidth,clipHeight)}context.clip.apply(context,clipArgs),m=transform.copy().invert().getMatrix(),context.transform(m[0],m[1],m[2],m[3],m[4],m[5])}var hasComposition=!selfCache&&this.globalCompositeOperation()!=="source-over"&&drawMethod==="drawScene";hasComposition&&(context.save(),context._applyGlobalCompositeOperation(this)),(_a=this.children)===null||_a===void 0||_a.forEach(function(child){child[drawMethod](canvas,top,bufferCanvas)}),hasComposition&&context.restore(),hasClip&&context.restore()}getClientRect(config={}){var _a,skipTransform=config.skipTransform,relativeTo=config.relativeTo,minX,minY,maxX,maxY,selfRect={x:1/0,y:1/0,width:0,height:0},that=this;(_a=this.children)===null||_a===void 0||_a.forEach(function(child){if(child.visible()){var rect=child.getClientRect({relativeTo:that,skipShadow:config.skipShadow,skipStroke:config.skipStroke});rect.width===0&&rect.height===0||(minX===void 0?(minX=rect.x,minY=rect.y,maxX=rect.x+rect.width,maxY=rect.y+rect.height):(minX=Math.min(minX,rect.x),minY=Math.min(minY,rect.y),maxX=Math.max(maxX,rect.x+rect.width),maxY=Math.max(maxY,rect.y+rect.height)))}});for(var shapes=this.find("Shape"),hasVisible=!1,i=0;i<shapes.length;i++){var shape=shapes[i];if(shape._isVisible(this)){hasVisible=!0;break}}return hasVisible&&minX!==void 0?selfRect={x:minX,y:minY,width:maxX-minX,height:maxY-minY}:selfRect={x:0,y:0,width:0,height:0},skipTransform?selfRect:this._transformedRect(selfRect,relativeTo)}}Container$1.Container=Container;Factory_1$5.Factory.addComponentsGetterSetter(Container,"clip",["x","y","width","height"]);Factory_1$5.Factory.addGetterSetter(Container,"clipX",void 0,(0,Validators_1$4.getNumberValidator)());Factory_1$5.Factory.addGetterSetter(Container,"clipY",void 0,(0,Validators_1$4.getNumberValidator)());Factory_1$5.Factory.addGetterSetter(Container,"clipWidth",void 0,(0,Validators_1$4.getNumberValidator)());Factory_1$5.Factory.addGetterSetter(Container,"clipHeight",void 0,(0,Validators_1$4.getNumberValidator)());Factory_1$5.Factory.addGetterSetter(Container,"clipFunc");var Stage={},PointerEvents={};Object.defineProperty(PointerEvents,"__esModule",{value:!0});PointerEvents.releaseCapture=PointerEvents.setPointerCapture=PointerEvents.hasPointerCapture=PointerEvents.createEvent=PointerEvents.getCapturedShape=void 0;const Global_1$8=Global,Captures=new Map,SUPPORT_POINTER_EVENTS=Global_1$8.Konva._global.PointerEvent!==void 0;function getCapturedShape(pointerId){return Captures.get(pointerId)}PointerEvents.getCapturedShape=getCapturedShape;function createEvent(evt){return{evt,pointerId:evt.pointerId}}PointerEvents.createEvent=createEvent;function hasPointerCapture(pointerId,shape){return Captures.get(pointerId)===shape}PointerEvents.hasPointerCapture=hasPointerCapture;function setPointerCapture(pointerId,shape){releaseCapture(pointerId),shape.getStage()&&(Captures.set(pointerId,shape),SUPPORT_POINTER_EVENTS&&shape._fire("gotpointercapture",createEvent(new PointerEvent("gotpointercapture"))))}PointerEvents.setPointerCapture=setPointerCapture;function releaseCapture(pointerId,target){const shape=Captures.get(pointerId);if(!shape)return;const stage2=shape.getStage();stage2&&stage2.content,Captures.delete(pointerId),SUPPORT_POINTER_EVENTS&&shape._fire("lostpointercapture",createEvent(new PointerEvent("lostpointercapture")))}PointerEvents.releaseCapture=releaseCapture;(function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.Stage=exports.stages=void 0;const Util_12=Util,Factory_12=Factory,Container_12=Container$1,Global_12=Global,Canvas_12=Canvas$1,DragAndDrop_12=DragAndDrop,Global_2=Global,PointerEvents$1=PointerEvents;var STAGE2="Stage",STRING="string",PX="px",MOUSEOUT="mouseout",MOUSELEAVE2="mouseleave",MOUSEOVER="mouseover",MOUSEENTER2="mouseenter",MOUSEMOVE="mousemove",MOUSEDOWN="mousedown",MOUSEUP="mouseup",POINTERMOVE="pointermove",POINTERDOWN="pointerdown",POINTERUP="pointerup",POINTERCANCEL="pointercancel",LOSTPOINTERCAPTURE="lostpointercapture",POINTEROUT="pointerout",POINTERLEAVE="pointerleave",POINTEROVER="pointerover",POINTERENTER="pointerenter",CONTEXTMENU="contextmenu",TOUCHSTART="touchstart",TOUCHEND="touchend",TOUCHMOVE="touchmove",TOUCHCANCEL="touchcancel",WHEEL="wheel",MAX_LAYERS_NUMBER=5,EVENTS=[[MOUSEENTER2,"_pointerenter"],[MOUSEDOWN,"_pointerdown"],[MOUSEMOVE,"_pointermove"],[MOUSEUP,"_pointerup"],[MOUSELEAVE2,"_pointerleave"],[TOUCHSTART,"_pointerdown"],[TOUCHMOVE,"_pointermove"],[TOUCHEND,"_pointerup"],[TOUCHCANCEL,"_pointercancel"],[MOUSEOVER,"_pointerover"],[WHEEL,"_wheel"],[CONTEXTMENU,"_contextmenu"],[POINTERDOWN,"_pointerdown"],[POINTERMOVE,"_pointermove"],[POINTERUP,"_pointerup"],[POINTERCANCEL,"_pointercancel"],[LOSTPOINTERCAPTURE,"_lostpointercapture"]];const EVENTS_MAP={mouse:{[POINTEROUT]:MOUSEOUT,[POINTERLEAVE]:MOUSELEAVE2,[POINTEROVER]:MOUSEOVER,[POINTERENTER]:MOUSEENTER2,[POINTERMOVE]:MOUSEMOVE,[POINTERDOWN]:MOUSEDOWN,[POINTERUP]:MOUSEUP,[POINTERCANCEL]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[POINTEROUT]:"touchout",[POINTERLEAVE]:"touchleave",[POINTEROVER]:"touchover",[POINTERENTER]:"touchenter",[POINTERMOVE]:TOUCHMOVE,[POINTERDOWN]:TOUCHSTART,[POINTERUP]:TOUCHEND,[POINTERCANCEL]:TOUCHCANCEL,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[POINTEROUT]:POINTEROUT,[POINTERLEAVE]:POINTERLEAVE,[POINTEROVER]:POINTEROVER,[POINTERENTER]:POINTERENTER,[POINTERMOVE]:POINTERMOVE,[POINTERDOWN]:POINTERDOWN,[POINTERUP]:POINTERUP,[POINTERCANCEL]:POINTERCANCEL,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},getEventType=type=>type.indexOf("pointer")>=0?"pointer":type.indexOf("touch")>=0?"touch":"mouse",getEventsMap=eventType=>{const type=getEventType(eventType);if(type==="pointer")return Global_12.Konva.pointerEventsEnabled&&EVENTS_MAP.pointer;if(type==="touch")return EVENTS_MAP.touch;if(type==="mouse")return EVENTS_MAP.mouse};function checkNoClip(attrs={}){return(attrs.clipFunc||attrs.clipWidth||attrs.clipHeight)&&Util_12.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),attrs}const NO_POINTERS_MESSAGE="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";exports.stages=[];class Stage2 extends Container_12.Container{constructor(config){super(checkNoClip(config)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),exports.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{checkNoClip(this.attrs)}),this._checkVisibility()}_validateAdd(child){const isLayer=child.getType()==="Layer",isFastLayer=child.getType()==="FastLayer";isLayer||isFastLayer||Util_12.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const style=this.visible()?"":"none";this.content.style.display=style}setContainer(container){if(typeof container===STRING){if(container.charAt(0)==="."){var className=container.slice(1);container=document.getElementsByClassName(className)[0]}else{var id;container.charAt(0)!=="#"?id=container:id=container.slice(1),container=document.getElementById(id)}if(!container)throw"Can not find container in document with id "+id}return this._setAttr("container",container),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),container.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){var layers=this.children,len=layers.length,n;for(n=0;n<len;n++)layers[n].clear();return this}clone(obj){return obj||(obj={}),obj.container=typeof document<"u"&&document.createElement("div"),Container_12.Container.prototype.clone.call(this,obj)}destroy(){super.destroy();var content=this.content;content&&Util_12.Util._isInDocument(content)&&this.container().removeChild(content);var index=exports.stages.indexOf(this);return index>-1&&exports.stages.splice(index,1),Util_12.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const pos=this._pointerPositions[0]||this._changedPointerPositions[0];return pos?{x:pos.x,y:pos.y}:(Util_12.Util.warn(NO_POINTERS_MESSAGE),null)}_getPointerById(id){return this._pointerPositions.find(p=>p.id===id)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(config){config=config||{},config.x=config.x||0,config.y=config.y||0,config.width=config.width||this.width(),config.height=config.height||this.height();var canvas=new Canvas_12.SceneCanvas({width:config.width,height:config.height,pixelRatio:config.pixelRatio||1}),_context=canvas.getContext()._context,layers=this.children;return(config.x||config.y)&&_context.translate(-1*config.x,-1*config.y),layers.forEach(function(layer){if(layer.isVisible()){var layerCanvas=layer._toKonvaCanvas(config);_context.drawImage(layerCanvas._canvas,config.x,config.y,layerCanvas.getWidth()/layerCanvas.getPixelRatio(),layerCanvas.getHeight()/layerCanvas.getPixelRatio())}}),canvas}getIntersection(pos){if(!pos)return null;var layers=this.children,len=layers.length,end=len-1,n;for(n=end;n>=0;n--){const shape=layers[n].getIntersection(pos);if(shape)return shape}return null}_resizeDOM(){var width=this.width(),height=this.height();this.content&&(this.content.style.width=width+PX,this.content.style.height=height+PX),this.bufferCanvas.setSize(width,height),this.bufferHitCanvas.setSize(width,height),this.children.forEach(layer=>{layer.setSize({width,height}),layer.draw()})}add(layer,...rest){if(arguments.length>1){for(var i=0;i<arguments.length;i++)this.add(arguments[i]);return this}super.add(layer);var length=this.children.length;return length>MAX_LAYERS_NUMBER&&Util_12.Util.warn("The stage has "+length+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),layer.setSize({width:this.width(),height:this.height()}),layer.draw(),Global_12.Konva.isBrowser&&this.content.appendChild(layer.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(pointerId){return PointerEvents$1.hasPointerCapture(pointerId,this)}setPointerCapture(pointerId){PointerEvents$1.setPointerCapture(pointerId,this)}releaseCapture(pointerId){PointerEvents$1.releaseCapture(pointerId,this)}getLayers(){return this.children}_bindContentEvents(){Global_12.Konva.isBrowser&&EVENTS.forEach(([event,methodName])=>{this.content.addEventListener(event,evt=>{this[methodName](evt)},{passive:!1})})}_pointerenter(evt){this.setPointersPositions(evt);const events=getEventsMap(evt.type);events&&this._fire(events.pointerenter,{evt,target:this,currentTarget:this})}_pointerover(evt){this.setPointersPositions(evt);const events=getEventsMap(evt.type);events&&this._fire(events.pointerover,{evt,target:this,currentTarget:this})}_getTargetShape(evenType){let shape=this[evenType+"targetShape"];return shape&&!shape.getStage()&&(shape=null),shape}_pointerleave(evt){const events=getEventsMap(evt.type),eventType=getEventType(evt.type);if(events){this.setPointersPositions(evt);var targetShape=this._getTargetShape(eventType),eventsEnabled=!(Global_12.Konva.isDragging()||Global_12.Konva.isTransforming())||Global_12.Konva.hitOnDragEnabled;targetShape&&eventsEnabled?(targetShape._fireAndBubble(events.pointerout,{evt}),targetShape._fireAndBubble(events.pointerleave,{evt}),this._fire(events.pointerleave,{evt,target:this,currentTarget:this}),this[eventType+"targetShape"]=null):eventsEnabled&&(this._fire(events.pointerleave,{evt,target:this,currentTarget:this}),this._fire(events.pointerout,{evt,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}}_pointerdown(evt){const events=getEventsMap(evt.type),eventType=getEventType(evt.type);if(events){this.setPointersPositions(evt);var triggeredOnShape=!1;this._changedPointerPositions.forEach(pos=>{var shape=this.getIntersection(pos);if(DragAndDrop_12.DD.justDragged=!1,Global_12.Konva["_"+eventType+"ListenClick"]=!0,!shape||!shape.isListening()){this[eventType+"ClickStartShape"]=void 0;return}Global_12.Konva.capturePointerEventsEnabled&&shape.setPointerCapture(pos.id),this[eventType+"ClickStartShape"]=shape,shape._fireAndBubble(events.pointerdown,{evt,pointerId:pos.id}),triggeredOnShape=!0;const isTouch=evt.type.indexOf("touch")>=0;shape.preventDefault()&&evt.cancelable&&isTouch&&evt.preventDefault()}),triggeredOnShape||this._fire(events.pointerdown,{evt,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}}_pointermove(evt){const events=getEventsMap(evt.type),eventType=getEventType(evt.type);if(!events)return;Global_12.Konva.isDragging()&&DragAndDrop_12.DD.node.preventDefault()&&evt.cancelable&&evt.preventDefault(),this.setPointersPositions(evt);var eventsEnabled=!(Global_12.Konva.isDragging()||Global_12.Konva.isTransforming())||Global_12.Konva.hitOnDragEnabled;if(!eventsEnabled)return;var processedShapesIds={};let triggeredOnShape=!1;var targetShape=this._getTargetShape(eventType);this._changedPointerPositions.forEach(pos=>{const shape=PointerEvents$1.getCapturedShape(pos.id)||this.getIntersection(pos),pointerId=pos.id,event={evt,pointerId};var differentTarget=targetShape!==shape;if(differentTarget&&targetShape&&(targetShape._fireAndBubble(events.pointerout,{...event},shape),targetShape._fireAndBubble(events.pointerleave,{...event},shape)),shape){if(processedShapesIds[shape._id])return;processedShapesIds[shape._id]=!0}shape&&shape.isListening()?(triggeredOnShape=!0,differentTarget&&(shape._fireAndBubble(events.pointerover,{...event},targetShape),shape._fireAndBubble(events.pointerenter,{...event},targetShape),this[eventType+"targetShape"]=shape),shape._fireAndBubble(events.pointermove,{...event})):targetShape&&(this._fire(events.pointerover,{evt,target:this,currentTarget:this,pointerId}),this[eventType+"targetShape"]=null)}),triggeredOnShape||this._fire(events.pointermove,{evt,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(evt){const events=getEventsMap(evt.type),eventType=getEventType(evt.type);if(!events)return;this.setPointersPositions(evt);const clickStartShape=this[eventType+"ClickStartShape"],clickEndShape=this[eventType+"ClickEndShape"];var processedShapesIds={};let triggeredOnShape=!1;this._changedPointerPositions.forEach(pos=>{const shape=PointerEvents$1.getCapturedShape(pos.id)||this.getIntersection(pos);if(shape){if(shape.releaseCapture(pos.id),processedShapesIds[shape._id])return;processedShapesIds[shape._id]=!0}const pointerId=pos.id,event={evt,pointerId};let fireDblClick=!1;Global_12.Konva["_"+eventType+"InDblClickWindow"]?(fireDblClick=!0,clearTimeout(this[eventType+"DblTimeout"])):DragAndDrop_12.DD.justDragged||(Global_12.Konva["_"+eventType+"InDblClickWindow"]=!0,clearTimeout(this[eventType+"DblTimeout"])),this[eventType+"DblTimeout"]=setTimeout(function(){Global_12.Konva["_"+eventType+"InDblClickWindow"]=!1},Global_12.Konva.dblClickWindow),shape&&shape.isListening()?(triggeredOnShape=!0,this[eventType+"ClickEndShape"]=shape,shape._fireAndBubble(events.pointerup,{...event}),Global_12.Konva["_"+eventType+"ListenClick"]&&clickStartShape&&clickStartShape===shape&&(shape._fireAndBubble(events.pointerclick,{...event}),fireDblClick&&clickEndShape&&clickEndShape===shape&&shape._fireAndBubble(events.pointerdblclick,{...event}))):(this[eventType+"ClickEndShape"]=null,Global_12.Konva["_"+eventType+"ListenClick"]&&this._fire(events.pointerclick,{evt,target:this,currentTarget:this,pointerId}),fireDblClick&&this._fire(events.pointerdblclick,{evt,target:this,currentTarget:this,pointerId}))}),triggeredOnShape||this._fire(events.pointerup,{evt,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),Global_12.Konva["_"+eventType+"ListenClick"]=!1,evt.cancelable&&eventType!=="touch"&&evt.preventDefault()}_contextmenu(evt){this.setPointersPositions(evt);var shape=this.getIntersection(this.getPointerPosition());shape&&shape.isListening()?shape._fireAndBubble(CONTEXTMENU,{evt}):this._fire(CONTEXTMENU,{evt,target:this,currentTarget:this})}_wheel(evt){this.setPointersPositions(evt);var shape=this.getIntersection(this.getPointerPosition());shape&&shape.isListening()?shape._fireAndBubble(WHEEL,{evt}):this._fire(WHEEL,{evt,target:this,currentTarget:this})}_pointercancel(evt){this.setPointersPositions(evt);const shape=PointerEvents$1.getCapturedShape(evt.pointerId)||this.getIntersection(this.getPointerPosition());shape&&shape._fireAndBubble(POINTERUP,PointerEvents$1.createEvent(evt)),PointerEvents$1.releaseCapture(evt.pointerId)}_lostpointercapture(evt){PointerEvents$1.releaseCapture(evt.pointerId)}setPointersPositions(evt){var contentPosition=this._getContentPosition(),x=null,y=null;evt=evt||window.event,evt.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(evt.touches,touch=>{this._pointerPositions.push({id:touch.identifier,x:(touch.clientX-contentPosition.left)/contentPosition.scaleX,y:(touch.clientY-contentPosition.top)/contentPosition.scaleY})}),Array.prototype.forEach.call(evt.changedTouches||evt.touches,touch=>{this._changedPointerPositions.push({id:touch.identifier,x:(touch.clientX-contentPosition.left)/contentPosition.scaleX,y:(touch.clientY-contentPosition.top)/contentPosition.scaleY})})):(x=(evt.clientX-contentPosition.left)/contentPosition.scaleX,y=(evt.clientY-contentPosition.top)/contentPosition.scaleY,this.pointerPos={x,y},this._pointerPositions=[{x,y,id:Util_12.Util._getFirstPointerId(evt)}],this._changedPointerPositions=[{x,y,id:Util_12.Util._getFirstPointerId(evt)}])}_setPointerPosition(evt){Util_12.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(evt)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var rect=this.content.getBoundingClientRect();return{top:rect.top,left:rect.left,scaleX:rect.width/this.content.clientWidth||1,scaleY:rect.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new Canvas_12.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new Canvas_12.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!!Global_12.Konva.isBrowser){var container=this.container();if(!container)throw"Stage has no container. A container is required.";container.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),container.appendChild(this.content),this._resizeDOM()}}cache(){return Util_12.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(layer){layer.batchDraw()}),this}}exports.Stage=Stage2,Stage2.prototype.nodeType=STAGE2,(0,Global_2._registerNode)(Stage2),Factory_12.Factory.addGetterSetter(Stage2,"container"),Global_12.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{exports.stages.forEach(stage2=>{stage2.batchDraw()})})})(Stage);var Layer$1={},Shape={};(function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.Shape=exports.shapes=void 0;const Global_12=Global,Util_12=Util,Factory_12=Factory,Node_12=Node$1,Validators_12=Validators,Global_2=Global,PointerEvents$1=PointerEvents;var HAS_SHADOW="hasShadow",SHADOW_RGBA="shadowRGBA",patternImage="patternImage",linearGradient="linearGradient",radialGradient="radialGradient";let dummyContext;function getDummyContext(){return dummyContext||(dummyContext=Util_12.Util.createCanvasElement().getContext("2d"),dummyContext)}exports.shapes={};function _fillFunc(context){const fillRule=this.attrs.fillRule;fillRule?context.fill(fillRule):context.fill()}function _strokeFunc(context){context.stroke()}function _fillFuncHit(context){const fillRule=this.attrs.fillRule;fillRule?context.fill(fillRule):context.fill()}function _strokeFuncHit(context){context.stroke()}function _clearHasShadowCache(){this._clearCache(HAS_SHADOW)}function _clearGetShadowRGBACache(){this._clearCache(SHADOW_RGBA)}function _clearFillPatternCache(){this._clearCache(patternImage)}function _clearLinearGradientCache(){this._clearCache(linearGradient)}function _clearRadialGradientCache(){this._clearCache(radialGradient)}class Shape2 extends Node_12.Node{constructor(config){super(config);let key;for(;key=Util_12.Util.getRandomColor(),!(key&&!(key in exports.shapes)););this.colorKey=key,exports.shapes[key]=this}getContext(){return Util_12.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return Util_12.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(HAS_SHADOW,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(patternImage,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){var ctx=getDummyContext();const pattern=ctx.createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(pattern&&pattern.setTransform){const tr=new Util_12.Transform;tr.translate(this.fillPatternX(),this.fillPatternY()),tr.rotate(Global_12.Konva.getAngle(this.fillPatternRotation())),tr.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),tr.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const m=tr.getMatrix(),matrix=typeof DOMMatrix>"u"?{a:m[0],b:m[1],c:m[2],d:m[3],e:m[4],f:m[5]}:new DOMMatrix(m);pattern.setTransform(matrix)}return pattern}}_getLinearGradient(){return this._getCache(linearGradient,this.__getLinearGradient)}__getLinearGradient(){var colorStops=this.fillLinearGradientColorStops();if(colorStops){for(var ctx=getDummyContext(),start=this.fillLinearGradientStartPoint(),end=this.fillLinearGradientEndPoint(),grd=ctx.createLinearGradient(start.x,start.y,end.x,end.y),n=0;n<colorStops.length;n+=2)grd.addColorStop(colorStops[n],colorStops[n+1]);return grd}}_getRadialGradient(){return this._getCache(radialGradient,this.__getRadialGradient)}__getRadialGradient(){var colorStops=this.fillRadialGradientColorStops();if(colorStops){for(var ctx=getDummyContext(),start=this.fillRadialGradientStartPoint(),end=this.fillRadialGradientEndPoint(),grd=ctx.createRadialGradient(start.x,start.y,this.fillRadialGradientStartRadius(),end.x,end.y,this.fillRadialGradientEndRadius()),n=0;n<colorStops.length;n+=2)grd.addColorStop(colorStops[n],colorStops[n+1]);return grd}}getShadowRGBA(){return this._getCache(SHADOW_RGBA,this._getShadowRGBA)}_getShadowRGBA(){if(this.hasShadow()){var rgba=Util_12.Util.colorToRGBA(this.shadowColor());if(rgba)return"rgba("+rgba.r+","+rgba.g+","+rgba.b+","+rgba.a*(this.shadowOpacity()||1)+")"}}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const width=this.hitStrokeWidth();return width==="auto"?this.hasStroke():this.strokeEnabled()&&!!width}intersects(point){var stage2=this.getStage();if(!stage2)return!1;const bufferHitCanvas=stage2.bufferHitCanvas;return bufferHitCanvas.getContext().clear(),this.drawHit(bufferHitCanvas,void 0,!0),bufferHitCanvas.context.getImageData(Math.round(point.x),Math.round(point.y),1,1).data[3]>0}destroy(){return Node_12.Node.prototype.destroy.call(this),delete exports.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(forceFill){var _a;if(!((_a=this.attrs.perfectDrawEnabled)!==null&&_a!==void 0?_a:!0))return!1;const hasFill=forceFill||this.hasFill(),hasStroke=this.hasStroke(),isTransparent=this.getAbsoluteOpacity()!==1;if(hasFill&&hasStroke&&isTransparent)return!0;const hasShadow=this.hasShadow(),strokeForShadow=this.shadowForStrokeEnabled();return!!(hasFill&&hasStroke&&hasShadow&&strokeForShadow)}setStrokeHitEnabled(val){Util_12.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),val?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){var size=this.size();return{x:this._centroid?-size.width/2:0,y:this._centroid?-size.height/2:0,width:size.width,height:size.height}}getClientRect(config={}){let hasCachedParent=!1,parent=this.getParent();for(;parent;){if(parent.isCached()){hasCachedParent=!0;break}parent=parent.getParent()}const skipTransform=config.skipTransform,relativeTo=config.relativeTo||hasCachedParent&&this.getStage()||void 0,fillRect=this.getSelfRect(),strokeWidth=!config.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,fillAndStrokeWidth=fillRect.width+strokeWidth,fillAndStrokeHeight=fillRect.height+strokeWidth,applyShadow=!config.skipShadow&&this.hasShadow(),shadowOffsetX=applyShadow?this.shadowOffsetX():0,shadowOffsetY=applyShadow?this.shadowOffsetY():0,preWidth=fillAndStrokeWidth+Math.abs(shadowOffsetX),preHeight=fillAndStrokeHeight+Math.abs(shadowOffsetY),blurRadius=applyShadow&&this.shadowBlur()||0,width=preWidth+blurRadius*2,height=preHeight+blurRadius*2,rect={width,height,x:-(strokeWidth/2+blurRadius)+Math.min(shadowOffsetX,0)+fillRect.x,y:-(strokeWidth/2+blurRadius)+Math.min(shadowOffsetY,0)+fillRect.y};return skipTransform?rect:this._transformedRect(rect,relativeTo)}drawScene(can,top,bufferCanvas){var layer=this.getLayer(),canvas=can||layer.getCanvas(),context=canvas.getContext(),cachedCanvas=this._getCanvasCache(),drawFunc=this.getSceneFunc(),hasShadow=this.hasShadow(),stage2,bufferContext,skipBuffer=canvas.isCache,cachingSelf=top===this;if(!this.isVisible()&&!cachingSelf)return this;if(cachedCanvas){context.save();var m=this.getAbsoluteTransform(top).getMatrix();return context.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._drawCachedSceneCanvas(context),context.restore(),this}if(!drawFunc)return this;if(context.save(),this._useBufferCanvas()&&!skipBuffer){stage2=this.getStage();const bc=bufferCanvas||stage2.bufferCanvas;bufferContext=bc.getContext(),bufferContext.clear(),bufferContext.save(),bufferContext._applyLineJoin(this);var o=this.getAbsoluteTransform(top).getMatrix();bufferContext.transform(o[0],o[1],o[2],o[3],o[4],o[5]),drawFunc.call(this,bufferContext,this),bufferContext.restore();var ratio=bc.pixelRatio;hasShadow&&context._applyShadow(this),context._applyOpacity(this),context._applyGlobalCompositeOperation(this),context.drawImage(bc._canvas,0,0,bc.width/ratio,bc.height/ratio)}else{if(context._applyLineJoin(this),!cachingSelf){var o=this.getAbsoluteTransform(top).getMatrix();context.transform(o[0],o[1],o[2],o[3],o[4],o[5]),context._applyOpacity(this),context._applyGlobalCompositeOperation(this)}hasShadow&&context._applyShadow(this),drawFunc.call(this,context,this)}return context.restore(),this}drawHit(can,top,skipDragCheck=!1){if(!this.shouldDrawHit(top,skipDragCheck))return this;var layer=this.getLayer(),canvas=can||layer.hitCanvas,context=canvas&&canvas.getContext(),drawFunc=this.hitFunc()||this.sceneFunc(),cachedCanvas=this._getCanvasCache(),cachedHitCanvas=cachedCanvas&&cachedCanvas.hit;if(this.colorKey||Util_12.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),cachedHitCanvas){context.save();var m=this.getAbsoluteTransform(top).getMatrix();return context.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._drawCachedHitCanvas(context),context.restore(),this}if(!drawFunc)return this;if(context.save(),context._applyLineJoin(this),!(this===top)){var o=this.getAbsoluteTransform(top).getMatrix();context.transform(o[0],o[1],o[2],o[3],o[4],o[5])}return drawFunc.call(this,context,this),context.restore(),this}drawHitFromCache(alphaThreshold=0){var cachedCanvas=this._getCanvasCache(),sceneCanvas=this._getCachedSceneCanvas(),hitCanvas=cachedCanvas.hit,hitContext=hitCanvas.getContext(),hitWidth=hitCanvas.getWidth(),hitHeight=hitCanvas.getHeight(),hitImageData,hitData,len,rgbColorKey,i,alpha;hitContext.clear(),hitContext.drawImage(sceneCanvas._canvas,0,0,hitWidth,hitHeight);try{for(hitImageData=hitContext.getImageData(0,0,hitWidth,hitHeight),hitData=hitImageData.data,len=hitData.length,rgbColorKey=Util_12.Util._hexToRgb(this.colorKey),i=0;i<len;i+=4)alpha=hitData[i+3],alpha>alphaThreshold?(hitData[i]=rgbColorKey.r,hitData[i+1]=rgbColorKey.g,hitData[i+2]=rgbColorKey.b,hitData[i+3]=255):hitData[i+3]=0;hitContext.putImageData(hitImageData,0,0)}catch(e){Util_12.Util.error("Unable to draw hit graph from cached scene canvas. "+e.message)}return this}hasPointerCapture(pointerId){return PointerEvents$1.hasPointerCapture(pointerId,this)}setPointerCapture(pointerId){PointerEvents$1.setPointerCapture(pointerId,this)}releaseCapture(pointerId){PointerEvents$1.releaseCapture(pointerId,this)}}exports.Shape=Shape2,Shape2.prototype._fillFunc=_fillFunc,Shape2.prototype._strokeFunc=_strokeFunc,Shape2.prototype._fillFuncHit=_fillFuncHit,Shape2.prototype._strokeFuncHit=_strokeFuncHit,Shape2.prototype._centroid=!1,Shape2.prototype.nodeType="Shape",(0,Global_2._registerNode)(Shape2),Shape2.prototype.eventListeners={},Shape2.prototype.on.call(Shape2.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",_clearHasShadowCache),Shape2.prototype.on.call(Shape2.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",_clearGetShadowRGBACache),Shape2.prototype.on.call(Shape2.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",_clearFillPatternCache),Shape2.prototype.on.call(Shape2.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",_clearLinearGradientCache),Shape2.prototype.on.call(Shape2.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",_clearRadialGradientCache),Factory_12.Factory.addGetterSetter(Shape2,"stroke",void 0,(0,Validators_12.getStringOrGradientValidator)()),Factory_12.Factory.addGetterSetter(Shape2,"strokeWidth",2,(0,Validators_12.getNumberValidator)()),Factory_12.Factory.addGetterSetter(Shape2,"fillAfterStrokeEnabled",!1),Factory_12.Factory.addGetterSetter(Shape2,"hitStrokeWidth","auto",(0,Validators_12.getNumberOrAutoValidator)()),Factory_12.Factory.addGetterSetter(Shape2,"strokeHitEnabled",!0,(0,Validators_12.getBooleanValidator)()),Factory_12.Factory.addGetterSetter(Shape2,"perfectDrawEnabled",!0,(0,Validators_12.getBooleanValidator)()),Factory_12.Factory.addGetterSetter(Shape2,"shadowForStrokeEnabled",!0,(0,Validators_12.getBooleanValidator)()),Factory_12.Factory.addGetterSetter(Shape2,"lineJoin"),Factory_12.Factory.addGetterSetter(Shape2,"lineCap"),Factory_12.Factory.addGetterSetter(Shape2,"sceneFunc"),Factory_12.Factory.addGetterSetter(Shape2,"hitFunc"),Factory_12.Factory.addGetterSetter(Shape2,"dash"),Factory_12.Factory.addGetterSetter(Shape2,"dashOffset",0,(0,Validators_12.getNumberValidator)()),Factory_12.Factory.addGetterSetter(Shape2,"shadowColor",void 0,(0,Validators_12.getStringValidator)()),Factory_12.Factory.addGetterSetter(Shape2,"shadowBlur",0,(0,Validators_12.getNumberValidator)()),Factory_12.Factory.addGetterSetter(Shape2,"shadowOpacity",1,(0,Validators_12.getNumberValidator)()),Factory_12.Factory.addComponentsGetterSetter(Shape2,"shadowOffset",["x","y"]),Factory_12.Factory.addGetterSetter(Shape2,"shadowOffsetX",0,(0,Validators_12.getNumberValidator)()),Factory_12.Factory.addGetterSetter(Shape2,"shadowOffsetY",0,(0,Validators_12.getNumberValidator)()),Factory_12.Factory.addGetterSetter(Shape2,"fillPatternImage"),Factory_12.Factory.addGetterSetter(Shape2,"fill",void 0,(0,Validators_12.getStringOrGradientValidator)()),Factory_12.Factory.addGetterSetter(Shape2,"fillPatternX",0,(0,Validators_12.getNumberValidator)()),Factory_12.Factory.addGetterSetter(Shape2,"fillPatternY",0,(0,Validators_12.getNumberValidator)()),Factory_12.Factory.addGetterSetter(Shape2,"fillLinearGradientColorStops"),Factory_12.Factory.addGetterSetter(Shape2,"strokeLinearGradientColorStops"),Factory_12.Factory.addGetterSetter(Shape2,"fillRadialGradientStartRadius",0),Factory_12.Factory.addGetterSetter(Shape2,"fillRadialGradientEndRadius",0),Factory_12.Factory.addGetterSetter(Shape2,"fillRadialGradientColorStops"),Factory_12.Factory.addGetterSetter(Shape2,"fillPatternRepeat","repeat"),Factory_12.Factory.addGetterSetter(Shape2,"fillEnabled",!0),Factory_12.Factory.addGetterSetter(Shape2,"strokeEnabled",!0),Factory_12.Factory.addGetterSetter(Shape2,"shadowEnabled",!0),Factory_12.Factory.addGetterSetter(Shape2,"dashEnabled",!0),Factory_12.Factory.addGetterSetter(Shape2,"strokeScaleEnabled",!0),Factory_12.Factory.addGetterSetter(Shape2,"fillPriority","color"),Factory_12.Factory.addComponentsGetterSetter(Shape2,"fillPatternOffset",["x","y"]),Factory_12.Factory.addGetterSetter(Shape2,"fillPatternOffsetX",0,(0,Validators_12.getNumberValidator)()),Factory_12.Factory.addGetterSetter(Shape2,"fillPatternOffsetY",0,(0,Validators_12.getNumberValidator)()),Factory_12.Factory.addComponentsGetterSetter(Shape2,"fillPatternScale",["x","y"]),Factory_12.Factory.addGetterSetter(Shape2,"fillPatternScaleX",1,(0,Validators_12.getNumberValidator)()),Factory_12.Factory.addGetterSetter(Shape2,"fillPatternScaleY",1,(0,Validators_12.getNumberValidator)()),Factory_12.Factory.addComponentsGetterSetter(Shape2,"fillLinearGradientStartPoint",["x","y"]),Factory_12.Factory.addComponentsGetterSetter(Shape2,"strokeLinearGradientStartPoint",["x","y"]),Factory_12.Factory.addGetterSetter(Shape2,"fillLinearGradientStartPointX",0),Factory_12.Factory.addGetterSetter(Shape2,"strokeLinearGradientStartPointX",0),Factory_12.Factory.addGetterSetter(Shape2,"fillLinearGradientStartPointY",0),Factory_12.Factory.addGetterSetter(Shape2,"strokeLinearGradientStartPointY",0),Factory_12.Factory.addComponentsGetterSetter(Shape2,"fillLinearGradientEndPoint",["x","y"]),Factory_12.Factory.addComponentsGetterSetter(Shape2,"strokeLinearGradientEndPoint",["x","y"]),Factory_12.Factory.addGetterSetter(Shape2,"fillLinearGradientEndPointX",0),Factory_12.Factory.addGetterSetter(Shape2,"strokeLinearGradientEndPointX",0),Factory_12.Factory.addGetterSetter(Shape2,"fillLinearGradientEndPointY",0),Factory_12.Factory.addGetterSetter(Shape2,"strokeLinearGradientEndPointY",0),Factory_12.Factory.addComponentsGetterSetter(Shape2,"fillRadialGradientStartPoint",["x","y"]),Factory_12.Factory.addGetterSetter(Shape2,"fillRadialGradientStartPointX",0),Factory_12.Factory.addGetterSetter(Shape2,"fillRadialGradientStartPointY",0),Factory_12.Factory.addComponentsGetterSetter(Shape2,"fillRadialGradientEndPoint",["x","y"]),Factory_12.Factory.addGetterSetter(Shape2,"fillRadialGradientEndPointX",0),Factory_12.Factory.addGetterSetter(Shape2,"fillRadialGradientEndPointY",0),Factory_12.Factory.addGetterSetter(Shape2,"fillPatternRotation",0),Factory_12.Factory.addGetterSetter(Shape2,"fillRule",void 0,(0,Validators_12.getStringValidator)()),Factory_12.Factory.backCompat(Shape2,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(Shape);Object.defineProperty(Layer$1,"__esModule",{value:!0});Layer$1.Layer=void 0;const Util_1$4=Util,Container_1$1=Container$1,Node_1=Node$1,Factory_1$4=Factory,Canvas_1=Canvas$1,Validators_1$3=Validators,Shape_1$3=Shape,Global_1$7=Global;var HASH="#",BEFORE_DRAW="beforeDraw",DRAW="draw",INTERSECTION_OFFSETS=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],INTERSECTION_OFFSETS_LEN=INTERSECTION_OFFSETS.length;class Layer extends Container_1$1.Container{constructor(config){super(config),this.canvas=new Canvas_1.SceneCanvas,this.hitCanvas=new Canvas_1.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(bounds){return this.getContext().clear(bounds),this.getHitCanvas().getContext().clear(bounds),this}setZIndex(index){super.setZIndex(index);var stage2=this.getStage();return stage2&&stage2.content&&(stage2.content.removeChild(this.getNativeCanvasElement()),index<stage2.children.length-1?stage2.content.insertBefore(this.getNativeCanvasElement(),stage2.children[index+1].getCanvas()._canvas):stage2.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Node_1.Node.prototype.moveToTop.call(this);var stage2=this.getStage();return stage2&&stage2.content&&(stage2.content.removeChild(this.getNativeCanvasElement()),stage2.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){var moved=Node_1.Node.prototype.moveUp.call(this);if(!moved)return!1;var stage2=this.getStage();return!stage2||!stage2.content?!1:(stage2.content.removeChild(this.getNativeCanvasElement()),this.index<stage2.children.length-1?stage2.content.insertBefore(this.getNativeCanvasElement(),stage2.children[this.index+1].getCanvas()._canvas):stage2.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Node_1.Node.prototype.moveDown.call(this)){var stage2=this.getStage();if(stage2){var children=stage2.children;stage2.content&&(stage2.content.removeChild(this.getNativeCanvasElement()),stage2.content.insertBefore(this.getNativeCanvasElement(),children[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Node_1.Node.prototype.moveToBottom.call(this)){var stage2=this.getStage();if(stage2){var children=stage2.children;stage2.content&&(stage2.content.removeChild(this.getNativeCanvasElement()),stage2.content.insertBefore(this.getNativeCanvasElement(),children[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){var _canvas=this.getNativeCanvasElement();return Node_1.Node.prototype.remove.call(this),_canvas&&_canvas.parentNode&&Util_1$4.Util._isInDocument(_canvas)&&_canvas.parentNode.removeChild(_canvas),this}getStage(){return this.parent}setSize({width,height}){return this.canvas.setSize(width,height),this.hitCanvas.setSize(width,height),this._setSmoothEnabled(),this}_validateAdd(child){var type=child.getType();type!=="Group"&&type!=="Shape"&&Util_1$4.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(config){return config=config||{},config.width=config.width||this.getWidth(),config.height=config.height||this.getHeight(),config.x=config.x!==void 0?config.x:this.x(),config.y=config.y!==void 0?config.y:this.y(),Node_1.Node.prototype._toKonvaCanvas.call(this,config)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Util_1$4.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Util_1$4.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Util_1$4.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(pos){if(!this.isListening()||!this.isVisible())return null;for(var spiralSearchDistance=1,continueSearch=!1;;){for(let i=0;i<INTERSECTION_OFFSETS_LEN;i++){const intersectionOffset=INTERSECTION_OFFSETS[i],obj=this._getIntersection({x:pos.x+intersectionOffset.x*spiralSearchDistance,y:pos.y+intersectionOffset.y*spiralSearchDistance}),shape=obj.shape;if(shape)return shape;if(continueSearch=!!obj.antialiased,!obj.antialiased)break}if(continueSearch)spiralSearchDistance+=1;else return null}}_getIntersection(pos){const ratio=this.hitCanvas.pixelRatio,p=this.hitCanvas.context.getImageData(Math.round(pos.x*ratio),Math.round(pos.y*ratio),1,1).data,p3=p[3];if(p3===255){const colorKey=Util_1$4.Util._rgbToHex(p[0],p[1],p[2]),shape=Shape_1$3.shapes[HASH+colorKey];return shape?{shape}:{antialiased:!0}}else if(p3>0)return{antialiased:!0};return{}}drawScene(can,top){var layer=this.getLayer(),canvas=can||layer&&layer.getCanvas();return this._fire(BEFORE_DRAW,{node:this}),this.clearBeforeDraw()&&canvas.getContext().clear(),Container_1$1.Container.prototype.drawScene.call(this,canvas,top),this._fire(DRAW,{node:this}),this}drawHit(can,top){var layer=this.getLayer(),canvas=can||layer&&layer.hitCanvas;return layer&&layer.clearBeforeDraw()&&layer.getHitCanvas().getContext().clear(),Container_1$1.Container.prototype.drawHit.call(this,canvas,top),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(val){Util_1$4.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(val)}getHitGraphEnabled(val){return Util_1$4.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!(!this.parent||!this.parent.content)){var parent=this.parent,added=!!this.hitCanvas._canvas.parentNode;added?parent.content.removeChild(this.hitCanvas._canvas):parent.content.appendChild(this.hitCanvas._canvas)}}destroy(){return Util_1$4.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}Layer$1.Layer=Layer;Layer.prototype.nodeType="Layer";(0,Global_1$7._registerNode)(Layer);Factory_1$4.Factory.addGetterSetter(Layer,"imageSmoothingEnabled",!0);Factory_1$4.Factory.addGetterSetter(Layer,"clearBeforeDraw",!0);Factory_1$4.Factory.addGetterSetter(Layer,"hitGraphEnabled",!0,(0,Validators_1$3.getBooleanValidator)());var FastLayer$1={};Object.defineProperty(FastLayer$1,"__esModule",{value:!0});FastLayer$1.FastLayer=void 0;const Util_1$3=Util,Layer_1=Layer$1,Global_1$6=Global;class FastLayer extends Layer_1.Layer{constructor(attrs){super(attrs),this.listening(!1),Util_1$3.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}FastLayer$1.FastLayer=FastLayer;FastLayer.prototype.nodeType="FastLayer";(0,Global_1$6._registerNode)(FastLayer);var Group$1={};Object.defineProperty(Group$1,"__esModule",{value:!0});Group$1.Group=void 0;const Util_1$2=Util,Container_1=Container$1,Global_1$5=Global;class Group extends Container_1.Container{_validateAdd(child){var type=child.getType();type!=="Group"&&type!=="Shape"&&Util_1$2.Util.throw("You may only add groups and shapes to groups.")}}Group$1.Group=Group;Group.prototype.nodeType="Group";(0,Global_1$5._registerNode)(Group);var Animation$1={};Object.defineProperty(Animation$1,"__esModule",{value:!0});Animation$1.Animation=void 0;const Global_1$4=Global,Util_1$1=Util,now=function(){return Global_1$4.glob.performance&&Global_1$4.glob.performance.now?function(){return Global_1$4.glob.performance.now()}:function(){return new Date().getTime()}}();class Animation{constructor(func,layers){this.id=Animation.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:now(),frameRate:0},this.func=func,this.setLayers(layers)}setLayers(layers){let lays=[];return layers&&(lays=Array.isArray(layers)?layers:[layers]),this.layers=lays,this}getLayers(){return this.layers}addLayer(layer){const layers=this.layers,len=layers.length;for(let n=0;n<len;n++)if(layers[n]._id===layer._id)return!1;return this.layers.push(layer),!0}isRunning(){const animations=Animation.animations,len=animations.length;for(let n=0;n<len;n++)if(animations[n].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=now(),Animation._addAnimation(this),this}stop(){return Animation._removeAnimation(this),this}_updateFrameObject(time){this.frame.timeDiff=time-this.frame.lastTime,this.frame.lastTime=time,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(anim){this.animations.push(anim),this._handleAnimation()}static _removeAnimation(anim){const id=anim.id,animations=this.animations,len=animations.length;for(let n=0;n<len;n++)if(animations[n].id===id){this.animations.splice(n,1);break}}static _runFrames(){const layerHash={},animations=this.animations;for(let n=0;n<animations.length;n++){const anim=animations[n],layers=anim.layers,func=anim.func;anim._updateFrameObject(now());const layersLen=layers.length;let needRedraw;if(func?needRedraw=func.call(anim,anim.frame)!==!1:needRedraw=!0,!!needRedraw)for(let i=0;i<layersLen;i++){const layer=layers[i];layer._id!==void 0&&(layerHash[layer._id]=layer)}}for(let key in layerHash)layerHash.hasOwnProperty(key)&&layerHash[key].batchDraw()}static _animationLoop(){const Anim=Animation;Anim.animations.length?(Anim._runFrames(),Util_1$1.Util.requestAnimFrame(Anim._animationLoop)):Anim.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,Util_1$1.Util.requestAnimFrame(this._animationLoop))}}Animation$1.Animation=Animation;Animation.animations=[];Animation.animIdCounter=0;Animation.animRunning=!1;var Tween={};(function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.Easings=exports.Tween=void 0;const Util_12=Util,Animation_1=Animation$1,Node_12=Node$1,Global_12=Global;var blacklist={node:1,duration:1,easing:1,onFinish:1,yoyo:1},PAUSED=1,PLAYING=2,REVERSING=3,idCounter2=0,colorAttrs=["fill","stroke","shadowColor"];class TweenEngine{constructor(prop,propFunc,func,begin,finish,duration,yoyo){this.prop=prop,this.propFunc=propFunc,this.begin=begin,this._pos=begin,this.duration=duration,this._change=0,this.prevPos=0,this.yoyo=yoyo,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=func,this._change=finish-this.begin,this.pause()}fire(str){var handler=this[str];handler&&handler()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(p){this.prevPos=this._pos,this.propFunc(p),this._pos=p}getPosition(t){return t===void 0&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=PLAYING,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=REVERSING,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){var t=this.getTimer()-this._startTime;this.state===PLAYING?this.setTime(t):this.state===REVERSING&&this.setTime(this.duration-t)}pause(){this.state=PAUSED,this.fire("onPause")}getTimer(){return new Date().getTime()}}class Tween2{constructor(config){var that=this,node=config.node,nodeId=node._id,duration,easing=config.easing||exports.Easings.Linear,yoyo=!!config.yoyo,key;typeof config.duration>"u"?duration=.3:config.duration===0?duration=.001:duration=config.duration,this.node=node,this._id=idCounter2++;var layers=node.getLayer()||(node instanceof Global_12.Konva.Stage?node.getLayers():null);layers||Util_12.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new Animation_1.Animation(function(){that.tween.onEnterFrame()},layers),this.tween=new TweenEngine(key,function(i){that._tweenFunc(i)},easing,0,1,duration*1e3,yoyo),this._addListeners(),Tween2.attrs[nodeId]||(Tween2.attrs[nodeId]={}),Tween2.attrs[nodeId][this._id]||(Tween2.attrs[nodeId][this._id]={}),Tween2.tweens[nodeId]||(Tween2.tweens[nodeId]={});for(key in config)blacklist[key]===void 0&&this._addAttr(key,config[key]);this.reset(),this.onFinish=config.onFinish,this.onReset=config.onReset,this.onUpdate=config.onUpdate}_addAttr(key,end){var node=this.node,nodeId=node._id,start,diff,tweenId,n,len,trueEnd,trueStart,endRGBA;if(tweenId=Tween2.tweens[nodeId][key],tweenId&&delete Tween2.attrs[nodeId][tweenId][key],start=node.getAttr(key),Util_12.Util._isArray(end))if(diff=[],len=Math.max(end.length,start.length),key==="points"&&end.length!==start.length&&(end.length>start.length?(trueStart=start,start=Util_12.Util._prepareArrayForTween(start,end,node.closed())):(trueEnd=end,end=Util_12.Util._prepareArrayForTween(end,start,node.closed()))),key.indexOf("fill")===0)for(n=0;n<len;n++)if(n%2===0)diff.push(end[n]-start[n]);else{var startRGBA=Util_12.Util.colorToRGBA(start[n]);endRGBA=Util_12.Util.colorToRGBA(end[n]),start[n]=startRGBA,diff.push({r:endRGBA.r-startRGBA.r,g:endRGBA.g-startRGBA.g,b:endRGBA.b-startRGBA.b,a:endRGBA.a-startRGBA.a})}else for(n=0;n<len;n++)diff.push(end[n]-start[n]);else colorAttrs.indexOf(key)!==-1?(start=Util_12.Util.colorToRGBA(start),endRGBA=Util_12.Util.colorToRGBA(end),diff={r:endRGBA.r-start.r,g:endRGBA.g-start.g,b:endRGBA.b-start.b,a:endRGBA.a-start.a}):diff=end-start;Tween2.attrs[nodeId][this._id][key]={start,diff,end,trueEnd,trueStart},Tween2.tweens[nodeId][key]=this._id}_tweenFunc(i){var node=this.node,attrs=Tween2.attrs[node._id][this._id],key,attr,start,diff,newVal,n,len,end;for(key in attrs){if(attr=attrs[key],start=attr.start,diff=attr.diff,end=attr.end,Util_12.Util._isArray(start))if(newVal=[],len=Math.max(start.length,end.length),key.indexOf("fill")===0)for(n=0;n<len;n++)n%2===0?newVal.push((start[n]||0)+diff[n]*i):newVal.push("rgba("+Math.round(start[n].r+diff[n].r*i)+","+Math.round(start[n].g+diff[n].g*i)+","+Math.round(start[n].b+diff[n].b*i)+","+(start[n].a+diff[n].a*i)+")");else for(n=0;n<len;n++)newVal.push((start[n]||0)+diff[n]*i);else colorAttrs.indexOf(key)!==-1?newVal="rgba("+Math.round(start.r+diff.r*i)+","+Math.round(start.g+diff.g*i)+","+Math.round(start.b+diff.b*i)+","+(start.a+diff.a*i)+")":newVal=start+diff*i;node.setAttr(key,newVal)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{var node=this.node,attrs=Tween2.attrs[node._id][this._id];attrs.points&&attrs.points.trueEnd&&node.setAttr("points",attrs.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{var node=this.node,attrs=Tween2.attrs[node._id][this._id];attrs.points&&attrs.points.trueStart&&node.points(attrs.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(t*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){var nodeId=this.node._id,thisId=this._id,attrs=Tween2.tweens[nodeId],key;this.pause();for(key in attrs)delete Tween2.tweens[nodeId][key];delete Tween2.attrs[nodeId][thisId]}}exports.Tween=Tween2,Tween2.attrs={},Tween2.tweens={},Node_12.Node.prototype.to=function(params){var onFinish=params.onFinish;params.node=this,params.onFinish=function(){this.destroy(),onFinish&&onFinish()};var tween=new Tween2(params);tween.play()},exports.Easings={BackEaseIn(t,b,c,d){var s=1.70158;return c*(t/=d)*t*((s+1)*t-s)+b},BackEaseOut(t,b,c,d){var s=1.70158;return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},BackEaseInOut(t,b,c,d){var s=1.70158;return(t/=d/2)<1?c/2*(t*t*(((s*=1.525)+1)*t-s))+b:c/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+b},ElasticEaseIn(t,b,c,d,a,p){var s=0;return t===0?b:(t/=d)===1?b+c:(p||(p=d*.3),!a||a<Math.abs(c)?(a=c,s=p/4):s=p/(2*Math.PI)*Math.asin(c/a),-(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b)},ElasticEaseOut(t,b,c,d,a,p){var s=0;return t===0?b:(t/=d)===1?b+c:(p||(p=d*.3),!a||a<Math.abs(c)?(a=c,s=p/4):s=p/(2*Math.PI)*Math.asin(c/a),a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b)},ElasticEaseInOut(t,b,c,d,a,p){var s=0;return t===0?b:(t/=d/2)===2?b+c:(p||(p=d*(.3*1.5)),!a||a<Math.abs(c)?(a=c,s=p/4):s=p/(2*Math.PI)*Math.asin(c/a),t<1?-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b:a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b)},BounceEaseOut(t,b,c,d){return(t/=d)<1/2.75?c*(7.5625*t*t)+b:t<2/2.75?c*(7.5625*(t-=1.5/2.75)*t+.75)+b:t<2.5/2.75?c*(7.5625*(t-=2.25/2.75)*t+.9375)+b:c*(7.5625*(t-=2.625/2.75)*t+.984375)+b},BounceEaseIn(t,b,c,d){return c-exports.Easings.BounceEaseOut(d-t,0,c,d)+b},BounceEaseInOut(t,b,c,d){return t<d/2?exports.Easings.BounceEaseIn(t*2,0,c,d)*.5+b:exports.Easings.BounceEaseOut(t*2-d,0,c,d)*.5+c*.5+b},EaseIn(t,b,c,d){return c*(t/=d)*t+b},EaseOut(t,b,c,d){return-c*(t/=d)*(t-2)+b},EaseInOut(t,b,c,d){return(t/=d/2)<1?c/2*t*t+b:-c/2*(--t*(t-2)-1)+b},StrongEaseIn(t,b,c,d){return c*(t/=d)*t*t*t*t+b},StrongEaseOut(t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},StrongEaseInOut(t,b,c,d){return(t/=d/2)<1?c/2*t*t*t*t*t+b:c/2*((t-=2)*t*t*t*t+2)+b},Linear(t,b,c,d){return c*t/d+b}}})(Tween);(function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.Konva=void 0;const Global_12=Global,Util_12=Util,Node_12=Node$1,Container_12=Container$1,Stage_1=Stage,Layer_12=Layer$1,FastLayer_1=FastLayer$1,Group_1=Group$1,DragAndDrop_12=DragAndDrop,Shape_12=Shape,Animation_1=Animation$1,Tween_1=Tween,Context_12=Context$1,Canvas_12=Canvas$1;exports.Konva=Util_12.Util._assign(Global_12.Konva,{Util:Util_12.Util,Transform:Util_12.Transform,Node:Node_12.Node,Container:Container_12.Container,Stage:Stage_1.Stage,stages:Stage_1.stages,Layer:Layer_12.Layer,FastLayer:FastLayer_1.FastLayer,Group:Group_1.Group,DD:DragAndDrop_12.DD,Shape:Shape_12.Shape,shapes:Shape_12.shapes,Animation:Animation_1.Animation,Tween:Tween_1.Tween,Easings:Tween_1.Easings,Context:Context_12.Context,Canvas:Canvas_12.Canvas}),exports.default=exports.Konva})(_CoreInternals);(function(module,exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.Konva=void 0;var _CoreInternals_1=_CoreInternals;Object.defineProperty(exports,"Konva",{enumerable:!0,get:function(){return _CoreInternals_1.Konva}});const _CoreInternals_2=_CoreInternals;module.exports=_CoreInternals_2.Konva})(Core,Core.exports);var CoreExports=Core.exports,Rect$1={};Object.defineProperty(Rect$1,"__esModule",{value:!0});var Rect_2=Rect$1.Rect=void 0;const Factory_1$3=Factory,Shape_1$2=Shape,Global_1$3=Global,Util_1=Util,Validators_1$2=Validators;class Rect extends Shape_1$2.Shape{_sceneFunc(context){var cornerRadius=this.cornerRadius(),width=this.width(),height=this.height();context.beginPath(),cornerRadius?Util_1.Util.drawRoundedRectPath(context,width,height,cornerRadius):context.rect(0,0,width,height),context.closePath(),context.fillStrokeShape(this)}}Rect_2=Rect$1.Rect=Rect;Rect.prototype.className="Rect";(0,Global_1$3._registerNode)(Rect);Factory_1$3.Factory.addGetterSetter(Rect,"cornerRadius",0,(0,Validators_1$2.getNumberOrArrayOfNumbersValidator)(4));var Arrow$1={},Line$1={};Object.defineProperty(Line$1,"__esModule",{value:!0});Line$1.Line=void 0;const Factory_1$2=Factory,Shape_1$1=Shape,Validators_1$1=Validators,Global_1$2=Global;function getControlPoints(x0,y0,x1,y1,x2,y2,t){var d01=Math.sqrt(Math.pow(x1-x0,2)+Math.pow(y1-y0,2)),d12=Math.sqrt(Math.pow(x2-x1,2)+Math.pow(y2-y1,2)),fa=t*d01/(d01+d12),fb=t*d12/(d01+d12),p1x=x1-fa*(x2-x0),p1y=y1-fa*(y2-y0),p2x=x1+fb*(x2-x0),p2y=y1+fb*(y2-y0);return[p1x,p1y,p2x,p2y]}function expandPoints(p,tension){var len=p.length,allPoints=[],n,cp;for(n=2;n<len-2;n+=2)cp=getControlPoints(p[n-2],p[n-1],p[n],p[n+1],p[n+2],p[n+3],tension),!isNaN(cp[0])&&(allPoints.push(cp[0]),allPoints.push(cp[1]),allPoints.push(p[n]),allPoints.push(p[n+1]),allPoints.push(cp[2]),allPoints.push(cp[3]));return allPoints}class Line extends Shape_1$1.Shape{constructor(config){super(config),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(context){var points=this.points(),length=points.length,tension=this.tension(),closed=this.closed(),bezier=this.bezier(),tp,len,n;if(length){if(context.beginPath(),context.moveTo(points[0],points[1]),tension!==0&&length>4){for(tp=this.getTensionPoints(),len=tp.length,n=closed?0:4,closed||context.quadraticCurveTo(tp[0],tp[1],tp[2],tp[3]);n<len-2;)context.bezierCurveTo(tp[n++],tp[n++],tp[n++],tp[n++],tp[n++],tp[n++]);closed||context.quadraticCurveTo(tp[len-2],tp[len-1],points[length-2],points[length-1])}else if(bezier)for(n=2;n<length;)context.bezierCurveTo(points[n++],points[n++],points[n++],points[n++],points[n++],points[n++]);else for(n=2;n<length;n+=2)context.lineTo(points[n],points[n+1]);closed?(context.closePath(),context.fillStrokeShape(this)):context.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():expandPoints(this.points(),this.tension())}_getTensionPointsClosed(){var p=this.points(),len=p.length,tension=this.tension(),firstControlPoints=getControlPoints(p[len-2],p[len-1],p[0],p[1],p[2],p[3],tension),lastControlPoints=getControlPoints(p[len-4],p[len-3],p[len-2],p[len-1],p[0],p[1],tension),middle=expandPoints(p,tension),tp=[firstControlPoints[2],firstControlPoints[3]].concat(middle).concat([lastControlPoints[0],lastControlPoints[1],p[len-2],p[len-1],lastControlPoints[2],lastControlPoints[3],firstControlPoints[0],firstControlPoints[1],p[0],p[1]]);return tp}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){var points=this.points();if(points.length<4)return{x:points[0]||0,y:points[1]||0,width:0,height:0};this.tension()!==0?points=[points[0],points[1],...this._getTensionPoints(),points[points.length-2],points[points.length-1]]:points=this.points();for(var minX=points[0],maxX=points[0],minY=points[1],maxY=points[1],x,y,i=0;i<points.length/2;i++)x=points[i*2],y=points[i*2+1],minX=Math.min(minX,x),maxX=Math.max(maxX,x),minY=Math.min(minY,y),maxY=Math.max(maxY,y);return{x:minX,y:minY,width:maxX-minX,height:maxY-minY}}}Line$1.Line=Line;Line.prototype.className="Line";Line.prototype._attrsAffectingSize=["points","bezier","tension"];(0,Global_1$2._registerNode)(Line);Factory_1$2.Factory.addGetterSetter(Line,"closed",!1);Factory_1$2.Factory.addGetterSetter(Line,"bezier",!1);Factory_1$2.Factory.addGetterSetter(Line,"tension",0,(0,Validators_1$1.getNumberValidator)());Factory_1$2.Factory.addGetterSetter(Line,"points",[],(0,Validators_1$1.getNumberArrayValidator)());var Path$1={},BezierFunctions={};(function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.t2length=exports.getQuadraticArcLength=exports.getCubicArcLength=exports.binomialCoefficients=exports.cValues=exports.tValues=void 0,exports.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],exports.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],exports.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const getCubicArcLength=(xs,ys,t)=>{let z,sum,correctedT;z=t/2,sum=0;for(let i=0;i<20;i++)correctedT=z*exports.tValues[20][i]+z,sum+=exports.cValues[20][i]*BFunc(xs,ys,correctedT);return z*sum};exports.getCubicArcLength=getCubicArcLength;const getQuadraticArcLength=(xs,ys,t)=>{t===void 0&&(t=1);const ax=xs[0]-2*xs[1]+xs[2],ay=ys[0]-2*ys[1]+ys[2],bx=2*xs[1]-2*xs[0],by=2*ys[1]-2*ys[0],A=4*(ax*ax+ay*ay),B=4*(ax*bx+ay*by),C=bx*bx+by*by;if(A===0)return t*Math.sqrt(Math.pow(xs[2]-xs[0],2)+Math.pow(ys[2]-ys[0],2));const b=B/(2*A),c=C/A,u=t+b,k=c-b*b,uuk=u*u+k>0?Math.sqrt(u*u+k):0,bbk=b*b+k>0?Math.sqrt(b*b+k):0,term=b+Math.sqrt(b*b+k)!==0?k*Math.log(Math.abs((u+uuk)/(b+bbk))):0;return Math.sqrt(A)/2*(u*uuk-b*bbk+term)};exports.getQuadraticArcLength=getQuadraticArcLength;function BFunc(xs,ys,t){const xbase=getDerivative(1,t,xs),ybase=getDerivative(1,t,ys),combined=xbase*xbase+ybase*ybase;return Math.sqrt(combined)}const getDerivative=(derivative,t,vs)=>{const n=vs.length-1;let _vs,value;if(n===0)return 0;if(derivative===0){value=0;for(let k=0;k<=n;k++)value+=exports.binomialCoefficients[n][k]*Math.pow(1-t,n-k)*Math.pow(t,k)*vs[k];return value}else{_vs=new Array(n);for(let k=0;k<n;k++)_vs[k]=n*(vs[k+1]-vs[k]);return getDerivative(derivative-1,t,_vs)}},t2length=(length,totalLength,func)=>{let error=1,t=length/totalLength,step=(length-func(t))/totalLength,numIterations=0;for(;error>.001;){const increasedTLength=func(t+step),increasedTError=Math.abs(length-increasedTLength)/totalLength;if(increasedTError<error)error=increasedTError,t+=step;else{const decreasedTLength=func(t-step),decreasedTError=Math.abs(length-decreasedTLength)/totalLength;decreasedTError<error?(error=decreasedTError,t-=step):step/=2}if(numIterations++,numIterations>500)break}return t};exports.t2length=t2length})(BezierFunctions);Object.defineProperty(Path$1,"__esModule",{value:!0});Path$1.Path=void 0;const Factory_1$1=Factory,Shape_1=Shape,Global_1$1=Global,BezierFunctions_1=BezierFunctions;class Path extends Shape_1.Shape{constructor(config){super(config),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Path.parsePathData(this.data()),this.pathLength=Path.getPathLength(this.dataArray)}_sceneFunc(context){var ca=this.dataArray;context.beginPath();for(var isClosed=!1,n=0;n<ca.length;n++){var c=ca[n].command,p=ca[n].points;switch(c){case"L":context.lineTo(p[0],p[1]);break;case"M":context.moveTo(p[0],p[1]);break;case"C":context.bezierCurveTo(p[0],p[1],p[2],p[3],p[4],p[5]);break;case"Q":context.quadraticCurveTo(p[0],p[1],p[2],p[3]);break;case"A":var cx=p[0],cy=p[1],rx=p[2],ry=p[3],theta=p[4],dTheta=p[5],psi=p[6],fs=p[7],r=rx>ry?rx:ry,scaleX=rx>ry?1:rx/ry,scaleY=rx>ry?ry/rx:1;context.translate(cx,cy),context.rotate(psi),context.scale(scaleX,scaleY),context.arc(0,0,r,theta,theta+dTheta,1-fs),context.scale(1/scaleX,1/scaleY),context.rotate(-psi),context.translate(-cx,-cy);break;case"z":isClosed=!0,context.closePath();break}}!isClosed&&!this.hasFill()?context.strokeShape(this):context.fillStrokeShape(this)}getSelfRect(){var points=[];this.dataArray.forEach(function(data){if(data.command==="A"){var start=data.points[4],dTheta=data.points[5],end=data.points[4]+dTheta,inc=Math.PI/180;if(Math.abs(start-end)<inc&&(inc=Math.abs(start-end)),dTheta<0)for(let t=start-inc;t>end;t-=inc){const point=Path.getPointOnEllipticalArc(data.points[0],data.points[1],data.points[2],data.points[3],t,0);points.push(point.x,point.y)}else for(let t=start+inc;t<end;t+=inc){const point=Path.getPointOnEllipticalArc(data.points[0],data.points[1],data.points[2],data.points[3],t,0);points.push(point.x,point.y)}}else if(data.command==="C")for(let t=0;t<=1;t+=.01){const point=Path.getPointOnCubicBezier(t,data.start.x,data.start.y,data.points[0],data.points[1],data.points[2],data.points[3],data.points[4],data.points[5]);points.push(point.x,point.y)}else points=points.concat(data.points)});for(var minX=points[0],maxX=points[0],minY=points[1],maxY=points[1],x,y,i=0;i<points.length/2;i++)x=points[i*2],y=points[i*2+1],isNaN(x)||(minX=Math.min(minX,x),maxX=Math.max(maxX,x)),isNaN(y)||(minY=Math.min(minY,y),maxY=Math.max(maxY,y));return{x:minX,y:minY,width:maxX-minX,height:maxY-minY}}getLength(){return this.pathLength}getPointAtLength(length){return Path.getPointAtLengthOfDataArray(length,this.dataArray)}static getLineLength(x1,y1,x2,y2){return Math.sqrt((x2-x1)*(x2-x1)+(y2-y1)*(y2-y1))}static getPathLength(dataArray){let pathLength=0;for(var i=0;i<dataArray.length;++i)pathLength+=dataArray[i].pathLength;return pathLength}static getPointAtLengthOfDataArray(length,dataArray){var point,i=0,ii=dataArray.length;if(!ii)return null;for(;i<ii&&length>dataArray[i].pathLength;)length-=dataArray[i].pathLength,++i;if(i===ii)return point=dataArray[i-1].points.slice(-2),{x:point[0],y:point[1]};if(length<.01)return point=dataArray[i].points.slice(0,2),{x:point[0],y:point[1]};var cp=dataArray[i],p=cp.points;switch(cp.command){case"L":return Path.getPointOnLine(length,cp.start.x,cp.start.y,p[0],p[1]);case"C":return Path.getPointOnCubicBezier((0,BezierFunctions_1.t2length)(length,Path.getPathLength(dataArray),i2=>(0,BezierFunctions_1.getCubicArcLength)([cp.start.x,p[0],p[2],p[4]],[cp.start.y,p[1],p[3],p[5]],i2)),cp.start.x,cp.start.y,p[0],p[1],p[2],p[3],p[4],p[5]);case"Q":return Path.getPointOnQuadraticBezier((0,BezierFunctions_1.t2length)(length,Path.getPathLength(dataArray),i2=>(0,BezierFunctions_1.getQuadraticArcLength)([cp.start.x,p[0],p[2]],[cp.start.y,p[1],p[3]],i2)),cp.start.x,cp.start.y,p[0],p[1],p[2],p[3]);case"A":var cx=p[0],cy=p[1],rx=p[2],ry=p[3],theta=p[4],dTheta=p[5],psi=p[6];return theta+=dTheta*length/cp.pathLength,Path.getPointOnEllipticalArc(cx,cy,rx,ry,theta,psi)}return null}static getPointOnLine(dist,P1x,P1y,P2x,P2y,fromX,fromY){fromX=fromX??P1x,fromY=fromY??P1y;const len=this.getLineLength(P1x,P1y,P2x,P2y);if(len<1e-10)return{x:P1x,y:P1y};if(P2x===P1x)return{x:fromX,y:fromY+(P2y>P1y?dist:-dist)};const m=(P2y-P1y)/(P2x-P1x),run=Math.sqrt(dist*dist/(1+m*m))*(P2x<P1x?-1:1),rise=m*run;if(Math.abs(fromY-P1y-m*(fromX-P1x))<1e-10)return{x:fromX+run,y:fromY+rise};const u=((fromX-P1x)*(P2x-P1x)+(fromY-P1y)*(P2y-P1y))/(len*len),ix=P1x+u*(P2x-P1x),iy=P1y+u*(P2y-P1y),pRise=this.getLineLength(fromX,fromY,ix,iy),pRun=Math.sqrt(dist*dist-pRise*pRise),adjustedRun=Math.sqrt(pRun*pRun/(1+m*m))*(P2x<P1x?-1:1),adjustedRise=m*adjustedRun;return{x:ix+adjustedRun,y:iy+adjustedRise}}static getPointOnCubicBezier(pct,P1x,P1y,P2x,P2y,P3x,P3y,P4x,P4y){function CB1(t){return t*t*t}function CB2(t){return 3*t*t*(1-t)}function CB3(t){return 3*t*(1-t)*(1-t)}function CB4(t){return(1-t)*(1-t)*(1-t)}var x=P4x*CB1(pct)+P3x*CB2(pct)+P2x*CB3(pct)+P1x*CB4(pct),y=P4y*CB1(pct)+P3y*CB2(pct)+P2y*CB3(pct)+P1y*CB4(pct);return{x,y}}static getPointOnQuadraticBezier(pct,P1x,P1y,P2x,P2y,P3x,P3y){function QB1(t){return t*t}function QB2(t){return 2*t*(1-t)}function QB3(t){return(1-t)*(1-t)}var x=P3x*QB1(pct)+P2x*QB2(pct)+P1x*QB3(pct),y=P3y*QB1(pct)+P2y*QB2(pct)+P1y*QB3(pct);return{x,y}}static getPointOnEllipticalArc(cx,cy,rx,ry,theta,psi){var cosPsi=Math.cos(psi),sinPsi=Math.sin(psi),pt={x:rx*Math.cos(theta),y:ry*Math.sin(theta)};return{x:cx+(pt.x*cosPsi-pt.y*sinPsi),y:cy+(pt.x*sinPsi+pt.y*cosPsi)}}static parsePathData(data){if(!data)return[];var cs=data,cc=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];cs=cs.replace(new RegExp(" ","g"),",");for(var n=0;n<cc.length;n++)cs=cs.replace(new RegExp(cc[n],"g"),"|"+cc[n]);var arr=cs.split("|"),ca=[],coords=[],cpx=0,cpy=0,re=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,match;for(n=1;n<arr.length;n++){var str=arr[n],c=str.charAt(0);for(str=str.slice(1),coords.length=0;match=re.exec(str);)coords.push(match[0]);for(var p=[],j=0,jlen=coords.length;j<jlen;j++){if(coords[j]==="00"){p.push(0,0);continue}var parsed=parseFloat(coords[j]);isNaN(parsed)?p.push(0):p.push(parsed)}for(;p.length>0&&!isNaN(p[0]);){var cmd="",points=[],startX=cpx,startY=cpy,prevCmd,ctlPtx,ctlPty,rx,ry,psi,fa,fs,x1,y1;switch(c){case"l":cpx+=p.shift(),cpy+=p.shift(),cmd="L",points.push(cpx,cpy);break;case"L":cpx=p.shift(),cpy=p.shift(),points.push(cpx,cpy);break;case"m":var dx=p.shift(),dy=p.shift();if(cpx+=dx,cpy+=dy,cmd="M",ca.length>2&&ca[ca.length-1].command==="z"){for(var idx=ca.length-2;idx>=0;idx--)if(ca[idx].command==="M"){cpx=ca[idx].points[0]+dx,cpy=ca[idx].points[1]+dy;break}}points.push(cpx,cpy),c="l";break;case"M":cpx=p.shift(),cpy=p.shift(),cmd="M",points.push(cpx,cpy),c="L";break;case"h":cpx+=p.shift(),cmd="L",points.push(cpx,cpy);break;case"H":cpx=p.shift(),cmd="L",points.push(cpx,cpy);break;case"v":cpy+=p.shift(),cmd="L",points.push(cpx,cpy);break;case"V":cpy=p.shift(),cmd="L",points.push(cpx,cpy);break;case"C":points.push(p.shift(),p.shift(),p.shift(),p.shift()),cpx=p.shift(),cpy=p.shift(),points.push(cpx,cpy);break;case"c":points.push(cpx+p.shift(),cpy+p.shift(),cpx+p.shift(),cpy+p.shift()),cpx+=p.shift(),cpy+=p.shift(),cmd="C",points.push(cpx,cpy);break;case"S":ctlPtx=cpx,ctlPty=cpy,prevCmd=ca[ca.length-1],prevCmd.command==="C"&&(ctlPtx=cpx+(cpx-prevCmd.points[2]),ctlPty=cpy+(cpy-prevCmd.points[3])),points.push(ctlPtx,ctlPty,p.shift(),p.shift()),cpx=p.shift(),cpy=p.shift(),cmd="C",points.push(cpx,cpy);break;case"s":ctlPtx=cpx,ctlPty=cpy,prevCmd=ca[ca.length-1],prevCmd.command==="C"&&(ctlPtx=cpx+(cpx-prevCmd.points[2]),ctlPty=cpy+(cpy-prevCmd.points[3])),points.push(ctlPtx,ctlPty,cpx+p.shift(),cpy+p.shift()),cpx+=p.shift(),cpy+=p.shift(),cmd="C",points.push(cpx,cpy);break;case"Q":points.push(p.shift(),p.shift()),cpx=p.shift(),cpy=p.shift(),points.push(cpx,cpy);break;case"q":points.push(cpx+p.shift(),cpy+p.shift()),cpx+=p.shift(),cpy+=p.shift(),cmd="Q",points.push(cpx,cpy);break;case"T":ctlPtx=cpx,ctlPty=cpy,prevCmd=ca[ca.length-1],prevCmd.command==="Q"&&(ctlPtx=cpx+(cpx-prevCmd.points[0]),ctlPty=cpy+(cpy-prevCmd.points[1])),cpx=p.shift(),cpy=p.shift(),cmd="Q",points.push(ctlPtx,ctlPty,cpx,cpy);break;case"t":ctlPtx=cpx,ctlPty=cpy,prevCmd=ca[ca.length-1],prevCmd.command==="Q"&&(ctlPtx=cpx+(cpx-prevCmd.points[0]),ctlPty=cpy+(cpy-prevCmd.points[1])),cpx+=p.shift(),cpy+=p.shift(),cmd="Q",points.push(ctlPtx,ctlPty,cpx,cpy);break;case"A":rx=p.shift(),ry=p.shift(),psi=p.shift(),fa=p.shift(),fs=p.shift(),x1=cpx,y1=cpy,cpx=p.shift(),cpy=p.shift(),cmd="A",points=this.convertEndpointToCenterParameterization(x1,y1,cpx,cpy,fa,fs,rx,ry,psi);break;case"a":rx=p.shift(),ry=p.shift(),psi=p.shift(),fa=p.shift(),fs=p.shift(),x1=cpx,y1=cpy,cpx+=p.shift(),cpy+=p.shift(),cmd="A",points=this.convertEndpointToCenterParameterization(x1,y1,cpx,cpy,fa,fs,rx,ry,psi);break}ca.push({command:cmd||c,points,start:{x:startX,y:startY},pathLength:this.calcLength(startX,startY,cmd||c,points)})}(c==="z"||c==="Z")&&ca.push({command:"z",points:[],start:void 0,pathLength:0})}return ca}static calcLength(x,y,cmd,points){var len,p1,p2,t,path=Path;switch(cmd){case"L":return path.getLineLength(x,y,points[0],points[1]);case"C":return(0,BezierFunctions_1.getCubicArcLength)([x,points[0],points[2],points[4]],[y,points[1],points[3],points[5]],1);case"Q":return(0,BezierFunctions_1.getQuadraticArcLength)([x,points[0],points[2]],[y,points[1],points[3]],1);case"A":len=0;var start=points[4],dTheta=points[5],end=points[4]+dTheta,inc=Math.PI/180;if(Math.abs(start-end)<inc&&(inc=Math.abs(start-end)),p1=path.getPointOnEllipticalArc(points[0],points[1],points[2],points[3],start,0),dTheta<0)for(t=start-inc;t>end;t-=inc)p2=path.getPointOnEllipticalArc(points[0],points[1],points[2],points[3],t,0),len+=path.getLineLength(p1.x,p1.y,p2.x,p2.y),p1=p2;else for(t=start+inc;t<end;t+=inc)p2=path.getPointOnEllipticalArc(points[0],points[1],points[2],points[3],t,0),len+=path.getLineLength(p1.x,p1.y,p2.x,p2.y),p1=p2;return p2=path.getPointOnEllipticalArc(points[0],points[1],points[2],points[3],end,0),len+=path.getLineLength(p1.x,p1.y,p2.x,p2.y),len}return 0}static convertEndpointToCenterParameterization(x1,y1,x2,y2,fa,fs,rx,ry,psiDeg){var psi=psiDeg*(Math.PI/180),xp=Math.cos(psi)*(x1-x2)/2+Math.sin(psi)*(y1-y2)/2,yp=-1*Math.sin(psi)*(x1-x2)/2+Math.cos(psi)*(y1-y2)/2,lambda=xp*xp/(rx*rx)+yp*yp/(ry*ry);lambda>1&&(rx*=Math.sqrt(lambda),ry*=Math.sqrt(lambda));var f=Math.sqrt((rx*rx*(ry*ry)-rx*rx*(yp*yp)-ry*ry*(xp*xp))/(rx*rx*(yp*yp)+ry*ry*(xp*xp)));fa===fs&&(f*=-1),isNaN(f)&&(f=0);var cxp=f*rx*yp/ry,cyp=f*-ry*xp/rx,cx=(x1+x2)/2+Math.cos(psi)*cxp-Math.sin(psi)*cyp,cy=(y1+y2)/2+Math.sin(psi)*cxp+Math.cos(psi)*cyp,vMag=function(v2){return Math.sqrt(v2[0]*v2[0]+v2[1]*v2[1])},vRatio=function(u2,v2){return(u2[0]*v2[0]+u2[1]*v2[1])/(vMag(u2)*vMag(v2))},vAngle=function(u2,v2){return(u2[0]*v2[1]<u2[1]*v2[0]?-1:1)*Math.acos(vRatio(u2,v2))},theta=vAngle([1,0],[(xp-cxp)/rx,(yp-cyp)/ry]),u=[(xp-cxp)/rx,(yp-cyp)/ry],v=[(-1*xp-cxp)/rx,(-1*yp-cyp)/ry],dTheta=vAngle(u,v);return vRatio(u,v)<=-1&&(dTheta=Math.PI),vRatio(u,v)>=1&&(dTheta=0),fs===0&&dTheta>0&&(dTheta=dTheta-2*Math.PI),fs===1&&dTheta<0&&(dTheta=dTheta+2*Math.PI),[cx,cy,rx,ry,theta,dTheta,psi,fs]}}Path$1.Path=Path;Path.prototype.className="Path";Path.prototype._attrsAffectingSize=["data"];(0,Global_1$1._registerNode)(Path);Factory_1$1.Factory.addGetterSetter(Path,"data");Object.defineProperty(Arrow$1,"__esModule",{value:!0});var Arrow_2=Arrow$1.Arrow=void 0;const Factory_1=Factory,Line_1=Line$1,Validators_1=Validators,Global_1=Global,Path_1=Path$1;class Arrow extends Line_1.Line{_sceneFunc(ctx){super._sceneFunc(ctx);var PI2=Math.PI*2,points=this.points(),tp=points,fromTension=this.tension()!==0&&points.length>4;fromTension&&(tp=this.getTensionPoints());var length=this.pointerLength(),n=points.length,dx,dy;if(fromTension){const lp=[tp[tp.length-4],tp[tp.length-3],tp[tp.length-2],tp[tp.length-1],points[n-2],points[n-1]],lastLength=Path_1.Path.calcLength(tp[tp.length-4],tp[tp.length-3],"C",lp),previous=Path_1.Path.getPointOnQuadraticBezier(Math.min(1,1-length/lastLength),lp[0],lp[1],lp[2],lp[3],lp[4],lp[5]);dx=points[n-2]-previous.x,dy=points[n-1]-previous.y}else dx=points[n-2]-points[n-4],dy=points[n-1]-points[n-3];var radians=(Math.atan2(dy,dx)+PI2)%PI2,width=this.pointerWidth();this.pointerAtEnding()&&(ctx.save(),ctx.beginPath(),ctx.translate(points[n-2],points[n-1]),ctx.rotate(radians),ctx.moveTo(0,0),ctx.lineTo(-length,width/2),ctx.lineTo(-length,-width/2),ctx.closePath(),ctx.restore(),this.__fillStroke(ctx)),this.pointerAtBeginning()&&(ctx.save(),ctx.beginPath(),ctx.translate(points[0],points[1]),fromTension?(dx=(tp[0]+tp[2])/2-points[0],dy=(tp[1]+tp[3])/2-points[1]):(dx=points[2]-points[0],dy=points[3]-points[1]),ctx.rotate((Math.atan2(-dy,-dx)+PI2)%PI2),ctx.moveTo(0,0),ctx.lineTo(-length,width/2),ctx.lineTo(-length,-width/2),ctx.closePath(),ctx.restore(),this.__fillStroke(ctx))}__fillStroke(ctx){var isDashEnabled=this.dashEnabled();isDashEnabled&&(this.attrs.dashEnabled=!1,ctx.setLineDash([])),ctx.fillStrokeShape(this),isDashEnabled&&(this.attrs.dashEnabled=!0)}getSelfRect(){const lineRect=super.getSelfRect(),offset=this.pointerWidth()/2;return{x:lineRect.x-offset,y:lineRect.y-offset,width:lineRect.width+offset*2,height:lineRect.height+offset*2}}}Arrow_2=Arrow$1.Arrow=Arrow;Arrow.prototype.className="Arrow";(0,Global_1._registerNode)(Arrow);Factory_1.Factory.addGetterSetter(Arrow,"pointerLength",10,(0,Validators_1.getNumberValidator)());Factory_1.Factory.addGetterSetter(Arrow,"pointerWidth",10,(0,Validators_1.getNumberValidator)());Factory_1.Factory.addGetterSetter(Arrow,"pointerAtBeginning",!1);Factory_1.Factory.addGetterSetter(Arrow,"pointerAtEnding",!0);function loader({base,baseProps={},plugins=[]}){const r=Reflect.construct(base,[baseProps]);return plugins.length>0&&(r==null||r.add(...plugins)),r}function deviceEmulationExited(){return!(navigator.userAgentData.mobile||navigator.userAgent.includes("Mobile"))}function setResources({scalingFactor,commonVecMagnitude,nodes=[]}){return nodes.length>0&&nodes.forEach(node=>{switch(node.name()){case"plugin$axis-west":case"plugin$axis-east":case"plugin$axis-north":case"plugin$axis-south":node.name()==="plugin$axis-west"?node.setAttr("points",[0,0,commonVecMagnitude*scalingFactor*+Math.cos(Math.PI),commonVecMagnitude*scalingFactor*-Math.sin(Math.PI)]):node.name()==="plugin$axis-east"?node.setAttr("points",[0,0,commonVecMagnitude*scalingFactor*-Math.cos(Math.PI),commonVecMagnitude*scalingFactor*+Math.sin(Math.PI)]):node.name()==="plugin$axis-north"?node.setAttr("points",[0,0,commonVecMagnitude*scalingFactor*+Math.cos(Math.PI/2),commonVecMagnitude*scalingFactor*-Math.sin(Math.PI/2)]):node.name()==="plugin$axis-south"&&node.setAttr("points",[0,0,commonVecMagnitude*scalingFactor*-Math.cos(Math.PI/2),commonVecMagnitude*scalingFactor*+Math.sin(Math.PI/2)]);break}switch(node.name()){case"plugin$rightTriangle-red":node.setAttr("points",[0,0,Math.sqrt(commonVecMagnitude**2+commonVecMagnitude**2)*scalingFactor*Math.cos(Math.PI/4),Math.sqrt(commonVecMagnitude**2+commonVecMagnitude**2)*scalingFactor*-Math.sin(Math.PI/4)]);break;case"plugin$rightTriangle-green":node.setAttrs({offsetX:-commonVecMagnitude*scalingFactor,points:[0,0,commonVecMagnitude*scalingFactor*Math.cos(Math.PI/2),commonVecMagnitude*scalingFactor*-Math.sin(Math.PI/2)]});break;case"plugin$rightTriangle-blue":node.setAttr("points",[0,0,commonVecMagnitude*scalingFactor*Math.cos(0),commonVecMagnitude*scalingFactor*-Math.sin(0)]);break}}),!0}function setRange(start,step,end,isIncluded=!0,skip=[]){const range=[];loop1:for(start;start<end+isIncluded;start+=step){for(let items of skip)if(items==start)continue loop1;range.push(start)}return range}class plugin$grid{static paint({base,gridConfig,baseProps_to_override={}}){const divisor=Math.floor(Number(gridConfig.stageWidth/gridConfig.gridcellDim)),matrixList=[];if(gridConfig.gridcellMatrix.length>0)for(let i=0;i<=divisor;i++)for(let k=0;k<=divisor;k++)matrixList.push(new base({name:`row${i+1}-col${k+1}`,x:gridConfig.gridcellMatrix[k],y:gridConfig.gridcellMatrix[i],width:Number(gridConfig.gridcellDim),height:Number(gridConfig.gridcellDim),stroke:"grey",strokeWidth:2,opacity:.5,...baseProps_to_override}));return matrixList}}class plugin$axis{static paint({namespace,base,baseProps_to_override={}}){return new base({name:`${plugin$axis.name}-${namespace}`,lineCap:"round",lineJoin:"round",strokeWidth:4,pointerLength:10,pointerWidth:10,fill:baseProps_to_override.stroke||"black",...baseProps_to_override})}}class plugin$rightTriangle{static paint({namespace,base,baseProps_to_override={}}){return new base({name:`${plugin$rightTriangle.name}-${namespace}`,stroke:"black",lineCap:"round",lineJoin:"round",strokeWidth:4,pointerLength:10,pointerWidth:10,fill:baseProps_to_override.stroke||"black",...baseProps_to_override})}}const name="muscle-coupling-pwa";document.addEventListener("DOMContentLoaded",()=>{document.title=name});let stage=null;__vitePreload(()=>import("./app-configs-0y85fcPK.js"),[],import.meta.url).then(({default:appConfigs})=>{stage=new CoreExports.Stage({container:document.body,width:Number(window.innerWidth),height:Number(window.innerHeight),...appConfigs==null?void 0:appConfigs.getAttrs()})}).finally(()=>{const configs=stage.getAttr("configs"),singleGridcell=configs["globals.scalingFactor"],[red,green,blue,black]=configs["enums.colors"];let divisorX=screen.orientation.type.includes("portrait")?Math.ceil(Number(stage.height()/singleGridcell)):Math.ceil(Number(stage.width()/singleGridcell)),divisorY=screen.orientation.type.includes("portrait")?Math.ceil(Number(stage.width()/singleGridcell)):Math.ceil(Number(stage.height()/singleGridcell));divisorX&&divisorY&&stage.setAttrs({width:divisorX*singleGridcell,height:divisorY*singleGridcell}),stage.add(loader({base:CoreExports.Layer,baseProps:{name:"layer-grid"},plugins:[loader({base:CoreExports.Group,baseProps:{name:"group-grid"},plugins:[...plugin$grid.paint({base:Rect_2,gridConfig:{stageWidth:stage.width(),gridcellDim:singleGridcell,gridcellMatrix:setRange(singleGridcell,singleGridcell,stage.width())}})]})]}),loader({base:CoreExports.Layer,baseProps:{name:"layer-axes"},plugins:[loader({base:CoreExports.Group,baseProps:{name:"group-axes",x:stage.width()/2,y:stage.height()/2},plugins:[plugin$axis.paint({namespace:"west",base:Arrow_2,baseProps_to_override:{stroke:black}}),plugin$axis.paint({namespace:"east",base:Arrow_2,baseProps_to_override:{stroke:black}}),plugin$axis.paint({namespace:"north",base:Arrow_2,baseProps_to_override:{stroke:black}}),plugin$axis.paint({namespace:"south",base:Arrow_2,baseProps_to_override:{stroke:black}})]})]}),loader({base:CoreExports.Layer,baseProps:{name:"layer-rightTriangle"},plugins:[loader({base:CoreExports.Group,baseProps:{name:"group-rightTriangle",x:stage.width()/2,y:stage.height()/2},plugins:[plugin$rightTriangle.paint({namespace:"red",base:Arrow_2,baseProps_to_override:{stroke:red}}),plugin$rightTriangle.paint({namespace:"green",base:Arrow_2,baseProps_to_override:{stroke:green}}),plugin$rightTriangle.paint({namespace:"blue",base:Arrow_2,baseProps_to_override:{stroke:blue}})]})]}))&&setResources({nodes:[...stage.findOne(".group-axes").getChildren(),...stage.findOne(".group-rightTriangle").getChildren()],scalingFactor:Number(singleGridcell),commonVecMagnitude:3});function resizeCanvas(){if(stage.setAttrs({width:window.innerWidth,height:window.innerHeight}),stage.height()>=stage.width()?(stage.findOne(".group-grid").removeChildren(),stage.findOne(".group-grid").add(...plugin$grid.paint({base:Rect_2,gridConfig:{stageWidth:stage.height(),gridcellDim:singleGridcell,gridcellMatrix:setRange(singleGridcell,singleGridcell,stage.height())}}))):(stage.findOne(".group-grid").removeChildren(),stage.findOne(".group-grid").add(...plugin$grid.paint({base:Rect_2,gridConfig:{stageWidth:stage.width(),gridcellDim:singleGridcell,gridcellMatrix:setRange(singleGridcell,singleGridcell,stage.width())}}))),stage==null||stage.findOne(".group-axes").setAttrs({x:Number(stage.width()/2),y:Number(stage.height()/2)}),stage==null||stage.findOne(".group-rightTriangle").setAttrs({x:Number(stage.width()/2),y:Number(stage.height()/2)}),deviceEmulationExited()){let divisorX2=screen.orientation.type.includes("portrait")?Math.ceil(Number(stage.height()/singleGridcell)):Math.ceil(Number(stage.width()/singleGridcell)),divisorY2=screen.orientation.type.includes("portrait")?Math.ceil(Number(stage.width()/singleGridcell)):Math.ceil(Number(stage.height()/singleGridcell));divisorX2&&divisorY2&&stage.setAttrs({width:divisorX2*singleGridcell,height:divisorY2*singleGridcell}),stage.height()>=stage.width()?(stage.findOne(".group-grid").removeChildren(),stage.findOne(".group-grid").add(...plugin$grid.paint({base:Rect_2,gridConfig:{stageWidth:stage.height(),gridcellDim:singleGridcell,gridcellMatrix:setRange(singleGridcell,singleGridcell,stage.height())}}))):(stage.findOne(".group-grid").removeChildren(),stage.findOne(".group-grid").add(...plugin$grid.paint({base:Rect_2,gridConfig:{stageWidth:stage.width(),gridcellDim:singleGridcell,gridcellMatrix:setRange(singleGridcell,singleGridcell,stage.width())}}))),stage==null||stage.findOne(".group-axes").setAttrs({x:Number(stage.width()/2),y:Number(stage.height()/2)}),stage==null||stage.findOne(".group-rightTriangle").setAttrs({x:Number(stage.width()/2),y:Number(stage.height()/2)})}return!0}screen.orientation.type.includes("portrait")&&resizeCanvas(),window.addEventListener("resize",resizeCanvas)});export{CoreExports as C,loader as l};
